<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="NgFq858mc61GVXVhz9J-Gw2smqS_Eqstq">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/black/pace-theme-center-simple.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"xuj14.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.12.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Anomaly Detection">
<meta property="og:type" content="article">
<meta property="og:title" content="Machine Learning Week09">
<meta property="og:url" content="https://xuj14.github.io/Machine-Learning-Week09/index.html">
<meta property="og:site_name" content="午尹">
<meta property="og:description" content="Anomaly Detection">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/xuJ14/ImageHost@latest/images/image-20210404220930233.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/xuJ14/ImageHost@latest/images/image-20210405114004132.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/xuJ14/ImageHost@latest/images/image-20210405203939050.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/xuJ14/ImageHost@latest/images/image-20210405214331278.png">
<meta property="article:published_time" content="2021-04-05T02:16:35.000Z">
<meta property="article:modified_time" content="2022-07-29T20:43:05.885Z">
<meta property="article:author" content="Jun XU">
<meta property="article:tag" content="Machine Learning">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/xuJ14/ImageHost@latest/images/image-20210404220930233.png">


<link rel="canonical" href="https://xuj14.github.io/Machine-Learning-Week09/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://xuj14.github.io/Machine-Learning-Week09/","path":"Machine-Learning-Week09/","title":"Machine Learning Week09"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Machine Learning Week09 | 午尹</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-SJCKHPPPPQ"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-SJCKHPPPPQ","only_pageview":false}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end -->
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">午尹</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Quant</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">7</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">0</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">20</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Anomaly-Detection-%E5%BC%82%E5%B8%B8%E6%A3%80%E6%B5%8B"><span class="nav-number">1.</span> <span class="nav-text">Anomaly Detection 异常检测</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Density-Estimation"><span class="nav-number">1.1.</span> <span class="nav-text">Density Estimation</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Problem-Motivation"><span class="nav-number">1.1.1.</span> <span class="nav-text">Problem Motivation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Gaussian-Distribution"><span class="nav-number">1.1.2.</span> <span class="nav-text">Gaussian Distribution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Algorithm"><span class="nav-number">1.1.3.</span> <span class="nav-text">Algorithm</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Building-an-Anomaly-Detection-System"><span class="nav-number">1.2.</span> <span class="nav-text">Building an Anomaly Detection System</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Developing-and-Evaluating-an-Anomaly-Detection-System"><span class="nav-number">1.2.1.</span> <span class="nav-text">Developing and Evaluating an Anomaly Detection System</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Anomaly-detection-vs-Supervised-learning"><span class="nav-number">1.2.2.</span> <span class="nav-text">Anomaly detection vs. Supervised learning</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Choosing-what-features-to-use"><span class="nav-number">1.2.3.</span> <span class="nav-text">Choosing what features to use</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Multivariate-Gaussian-Distribution"><span class="nav-number">1.3.</span> <span class="nav-text">Multivariate Gaussian Distribution</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Multivariate-Gaussian-Distribution-1"><span class="nav-number">1.3.1.</span> <span class="nav-text">Multivariate Gaussian Distribution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Anomaly-Detection-using-the-multivariate-Gaussian-distribution"><span class="nav-number">1.3.2.</span> <span class="nav-text">Anomaly Detection using the multivariate Gaussian distribution</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Predicting-Movie-Ratings-%E2%80%94%E2%80%94Recommendation-System"><span class="nav-number">1.4.</span> <span class="nav-text">Predicting Movie Ratings ——Recommendation System</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Problem-Formulation"><span class="nav-number">1.4.1.</span> <span class="nav-text">Problem Formulation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Content-Based-Recommendations"><span class="nav-number">1.4.2.</span> <span class="nav-text">Content Based Recommendations</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Collaborative-Filtering"><span class="nav-number">1.5.</span> <span class="nav-text">Collaborative Filtering</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Collaborative-Filtering-1"><span class="nav-number">1.5.1.</span> <span class="nav-text">Collaborative Filtering</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Low-Rank-Matrix-Factorization"><span class="nav-number">1.6.</span> <span class="nav-text">Low Rank Matrix Factorization</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Vectorization"><span class="nav-number">1.6.1.</span> <span class="nav-text">Vectorization</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Mean-Normalization"><span class="nav-number">1.6.2.</span> <span class="nav-text">Mean Normalization</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Jun XU"
      src="/gallery/avator.jpg">
  <p class="site-author-name" itemprop="name">Jun XU</p>
  <div class="site-description" itemprop="description">Hope to give you some inspiration</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">20</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/xuJ14" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;xuJ14" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:jun.xu14@gmail.com" title="E-Mail → mailto:jun.xu14@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/xuJ14" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://xuj14.github.io/Machine-Learning-Week09/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/gallery/avator.jpg">
      <meta itemprop="name" content="Jun XU">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="午尹">
      <meta itemprop="description" content="Hope to give you some inspiration">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Machine Learning Week09 | 午尹">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Machine Learning Week09
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-04-04 22:16:35" itemprop="dateCreated datePublished" datetime="2021-04-04T22:16:35-04:00">2021-04-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-07-29 16:43:05" itemprop="dateModified" datetime="2022-07-29T16:43:05-04:00">2022-07-29</time>
    </span>

  
    <span id="/Machine-Learning-Week09/" class="post-meta-item leancloud_visitors" data-flag-title="Machine Learning Week09" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>6.5k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>6 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="Anomaly-Detection-异常检测"><a href="#Anomaly-Detection-异常检测" class="headerlink" title="Anomaly Detection 异常检测"></a>Anomaly Detection 异常检测</h1><h2 id="Density-Estimation"><a href="#Density-Estimation" class="headerlink" title="Density Estimation"></a>Density Estimation</h2><h3 id="Problem-Motivation"><a href="#Problem-Motivation" class="headerlink" title="Problem Motivation"></a>Problem Motivation</h3><p>异常检测主要用于unsupervised learning</p>
<p>Model：$P(x_{test}&lt;\epsilon)\rightarrow anomaly$</p>
<p>​                $P(x_{test}\ge \epsilon)\rightarrow OK$</p>
<p>也被用于检测账号被盗、生产、数据中心的电脑</p>
<h3 id="Gaussian-Distribution"><a href="#Gaussian-Distribution" class="headerlink" title="Gaussian Distribution"></a>Gaussian Distribution</h3><p>=Normal distribution</p>
<p>X ～ N (0, 1)，“distributed as”, 这里N的符号为”script N”</p>
<p>给定dataset，参数估计：via Maximum likelihood estimation 通常是m-1，对大数据集没影响</p>
<script type="math/tex; mode=display">
\mu = \frac{1}{m}\sum_{i=1}^mx^{(i)}\\
\sigma^2=\frac{1}{m}\sum_{i=1}^m(x^{(i)}-\mu)^2</script><h3 id="Algorithm"><a href="#Algorithm" class="headerlink" title="Algorithm"></a>Algorithm</h3><p>基本假设，各特征间相互独立</p>
<script type="math/tex; mode=display">
P(x)=\prod_{j=1}^np(x_j;\mu_j,\sigma_j^2)</script><p><img src="https://cdn.jsdelivr.net/gh/xuJ14/ImageHost@latest/images/image-20210404220930233.png" alt="Anomaly detection algorithm"></p>
<h2 id="Building-an-Anomaly-Detection-System"><a href="#Building-an-Anomaly-Detection-System" class="headerlink" title="Building an Anomaly Detection System"></a>Building an Anomaly Detection System</h2><h3 id="Developing-and-Evaluating-an-Anomaly-Detection-System"><a href="#Developing-and-Evaluating-an-Anomaly-Detection-System" class="headerlink" title="Developing and Evaluating an Anomaly Detection System"></a>Developing and Evaluating an Anomaly Detection System</h3><p>Training set: normal examples (可以有少量异常的混进来)</p>
<p>然后应用于cross calidation set 和 test set</p>
<ul>
<li><p>10000正常，20异常：</p>
<p>​    训练集：6000正常</p>
<p>​    CV：2000正常，10异常</p>
<p>​    Test：2000正常，10异常</p>
</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/xuJ14/ImageHost@latest/images/image-20210405114004132.png" alt="Algorithm evaluation"></p>
<p>由于normal是0，所以预测0常常有更高的准确率，是skew的偏斜的。因此查准率accuracy不是很好的分析指标。</p>
<ul>
<li>选择ε时，可以试几个不同的，然后选择使得Cross validation集中F1-score最大的，或者效果最好的。</li>
<li>有时还需要决定用什么特征</li>
</ul>
<h3 id="Anomaly-detection-vs-Supervised-learning"><a href="#Anomaly-detection-vs-Supervised-learning" class="headerlink" title="Anomaly detection vs. Supervised learning"></a>Anomaly detection vs. Supervised learning</h3><p>Anomaly detection:</p>
<ul>
<li>y=1非常少(0-20常见), y=0占比更大</li>
<li>有大量不同的异常类型，其他算法难于分辨各种类型</li>
<li>有未知异常类型</li>
</ul>
<p>supervised learning：</p>
<ul>
<li>大量的positive 和negative examples</li>
<li>有足够positive examples，并且未来的positive example和训练集的相似</li>
<li>Spam</li>
</ul>
<h3 id="Choosing-what-features-to-use"><a href="#Choosing-what-features-to-use" class="headerlink" title="Choosing what features to use"></a>Choosing what features to use</h3><ul>
<li>Non-gaussian feature</li>
</ul>
<p>绘制特征的直方图，看是否大致是个bell shaped curve，如果不是，运用一些变换使得其看起来更加gaussian</p>
<p><img src="https://cdn.jsdelivr.net/gh/xuJ14/ImageHost@latest/images/image-20210405203939050.png" alt="take a log transformation"></p>
<ul>
<li><p>Error analysis for anomaly detection</p>
<p>甄别失败时，new feature 可能有帮助，例如组合现有的特征形成新特征</p>
</li>
</ul>
<h2 id="Multivariate-Gaussian-Distribution"><a href="#Multivariate-Gaussian-Distribution" class="headerlink" title="Multivariate Gaussian Distribution"></a>Multivariate Gaussian Distribution</h2><h3 id="Multivariate-Gaussian-Distribution-1"><a href="#Multivariate-Gaussian-Distribution-1" class="headerlink" title="Multivariate Gaussian Distribution"></a>Multivariate Gaussian Distribution</h3><p>不同于之前的是，p(x)不再是各个特征概率的乘积。</p>
<p>Parameters: $\mu \in \R^n$, $\Sigma \in \R^{n\times n}$</p>
<script type="math/tex; mode=display">
p(x;\mu,\Sigma)= \frac{1}{(2\pi)^{\frac{n}{2}}|\Sigma|^2}exp(-\frac{1}{2}(x-\mu)^T\Sigma^{-1}(x-\mu))</script><p>$|\Sigma|$=determinant of Σ </p>
<p><img src="https://cdn.jsdelivr.net/gh/xuJ14/ImageHost@latest/images/image-20210405214331278.png" alt="examples"></p>
<script type="math/tex; mode=display">
\mu = \frac{1}{m}\sum_{i=1}^mx^{(i)}\\
\Sigma = \frac{1}{m}\sum_{i=1}^m(x^{(i)}-\mu)(x^{(i)}-\mu)^T</script><h3 id="Anomaly-Detection-using-the-multivariate-Gaussian-distribution"><a href="#Anomaly-Detection-using-the-multivariate-Gaussian-distribution" class="headerlink" title="Anomaly Detection using the multivariate Gaussian distribution"></a>Anomaly Detection using the multivariate Gaussian distribution</h3><p>首先计算μ和Σ，然后计算p(x)，最后根据ε判断是否异常</p>
<ul>
<li><p>优点：自动捕捉特征间的相关性。m&gt;10n用起来才比较好，必须要m&gt;n，否则协方差矩阵不可逆。</p>
</li>
<li><p>缺点：计算量比较大。如果某个特征是其他的线性组合，那么协方差矩阵也不可逆，要注意避免。</p>
</li>
</ul>
<p>前述的模型：优点在于计算量小，但是要人工创造一些新特征来更好地分辨。m&lt;n的时候也能用。</p>
<p>若出现协方差矩阵不可逆：</p>
<ul>
<li>首先检查m, n大小</li>
<li>检查是否有redundant features，就是特征间是否线性独立</li>
</ul>
<h2 id="Predicting-Movie-Ratings-——Recommendation-System"><a href="#Predicting-Movie-Ratings-——Recommendation-System" class="headerlink" title="Predicting Movie Ratings ——Recommendation System"></a>Predicting Movie Ratings ——Recommendation System</h2><h3 id="Problem-Formulation"><a href="#Problem-Formulation" class="headerlink" title="Problem Formulation"></a>Problem Formulation</h3><p>r(i,j) 表示第i个电影，j用户是否打分；</p>
<p>y(i,j) 表示该用户对该电影的打分值 ；</p>
<h3 id="Content-Based-Recommendations"><a href="#Content-Based-Recommendations" class="headerlink" title="Content Based Recommendations"></a>Content Based Recommendations</h3><p>设电影特征n个</p>
<p>For each user j, learn a parameter $\theta^{(j)}\in\R^{n+1}$. Predict user j as rating movie i with $(\theta^{(j)})^Tx^{(i)}$ stars. （注意 $x_0=1$）。用线性回归</p>
<p>To learn $\theta^{(j)}$：</p>
<script type="math/tex; mode=display">
\min_{\Theta^{(j)}}\frac{1}{2m^{(j)}}\sum_{i:r(i,j)=1}((\theta^{(j)})^Tx^{(i)}-y^{(i,j)})^2+\frac{\lambda}{2m^{(j)}}\sum_{k=1}^{n}(\theta_k^{(j)})^2</script><p>Note: 这里 $m^{(j)}$可以去掉，对结果没有任何影响</p>
<p>优化目标也可以为：</p>
<script type="math/tex; mode=display">
J(\Theta^{(1)},...,\Theta^{(n_u)})=\min_{\Theta^{(1)},...,\Theta^{(n_u)}}\frac{1}{2}\sum_{j=1}^{n_u}\sum_{i:r(i,j)=1}((\theta^{(j)})^Tx^{(i)}-y^{(i,j)})^2+\frac{\lambda}{2}\sum_{j=1}^{n_u}\sum_{k=1}^{n}(\theta_k^{(j)})^2</script><p>Gradient descent update:</p>
<script type="math/tex; mode=display">
\theta_{k}^{(j)}:=\theta_{k}^{(j)}-\alpha \sum_{i: r(i, j)=1}\left(\left(\theta^{(j)}\right)^{T} x^{(i)}-y^{(i, j)}\right) x_{k}^{(i)}\ (\text { for } k=0)</script><script type="math/tex; mode=display">
\theta_{k}^{(j)}:=\theta_{k}^{(j)}-\alpha\left(\sum_{i: r(i, j)=1}\left(\left(\theta^{(j)}\right)^{T} x^{(i)}-y^{(i, j)}\right) x_{k}^{(i)}+\lambda \theta_{k}^{(j)}\right)\ (\text { for } k \neq 0)</script><p>k=0的时候不加正则项</p>
<h2 id="Collaborative-Filtering"><a href="#Collaborative-Filtering" class="headerlink" title="Collaborative Filtering"></a>Collaborative Filtering</h2><h3 id="Collaborative-Filtering-1"><a href="#Collaborative-Filtering-1" class="headerlink" title="Collaborative Filtering"></a>Collaborative Filtering</h3><ul>
<li>feature learning</li>
<li>Given $\Theta^{(1)},…,\Theta^{(n_u)}$，to learn $x^{(1)},…,x^{(n_m)}$;</li>
<li>算法类似7、8式</li>
<li>$用户的\Theta\rightarrow 电影特征x\rightarrow \Theta\rightarrow x\rightarrow…$</li>
<li><p>每个用户都在帮助这个推荐系统更好地分类电影，从而更好地预测评分</p>
</li>
<li><p>算法：同时实现：</p>
<ol>
<li><p>Given $x^{(1)},…,x^{(n_m)}$，estimate $\theta^{(1)},…,\theta^{(n_u)}$：</p>
<script type="math/tex; mode=display">
\min_{\Theta^{(j)}}\frac{1}{2m^{(j)}}\sum_{i:r(i,j)=1}((\theta^{(j)})^Tx^{(i)}-y^{(i,j)})^2+\frac{\lambda}{2m^{(j)}}\sum_{k=1}^{n}(\theta_k^{(j)})^2</script></li>
<li><p>Given $\theta^{(1)},…,\theta^{(n_u)}$，estimate $x^{(1)},…,x^{(n_m)}$：</p>
<script type="math/tex; mode=display">
\min _{x^{(1)}, \ldots, x^{\left(n_{m}\right)}} \frac{1}{2} \sum_{i=1}^{n_{m}} \sum_{j: r(i, j)=1}\left(\left(\theta^{(j)}\right)^{T} x^{(i)}-y^{(i, j)}\right)^{2}+\frac{\lambda}{2} \sum_{i=1}^{n_{m}} \sum_{k=1}^{n}\left(x_{k}^{(i)}\right)^{2}</script></li>
</ol>
<p>即：</p>
<p>Minimizing $x^{(1)},…,x^{(n_m)}$ and $\theta^{(1)},…,\theta^{(n_u)}$ simultaneously：</p>
<script type="math/tex; mode=display">
\min_{x^{(1)},...,x^{(n_m)}\\\theta^{(1)},...,\theta^{(n_u)}}J\left(x^{(1)}, \ldots, x^{\left(n_{m}\right)}, \theta^{(1)}, \ldots, \theta^{\left(n_{u}\right)}\right)</script><script type="math/tex; mode=display">
J\left(x^{(1)}, \ldots, x^{\left(n_{m}\right)}, \theta^{(1)}, \ldots, \theta^{\left(n_{u}\right)}\right)=\frac{1}{2} \sum_{(i, j): r(i, j)=1}\left(\left(\theta^{(j)}\right)^{T} x^{(i)}-y^{(i, j)}\right)^{2}+\frac{\lambda}{2} \sum_{i=1}^{n_{m}} \sum_{k=1}^{n}\left(x_{k}^{(i)}\right)^{2}+\frac{\lambda}{2} \sum_{j=1}^{n_{u}} \sum_{k=1}^{n}\left(\theta_{k}^{(j)}\right)^{2}</script><blockquote>
<p>该算法下，无需设定 $x_0=1$, 也没有$\theta_0$，因为算法会自行选择参数。该算法下：$\theta\in\R^n$，$x\in\R^n$，n是特征数</p>
</blockquote>
</li>
<li><p>算法实现：</p>
<ol>
<li>Initialize $x^{(1)},…,x^{(n_m)}$， $\theta^{(1)},…,\theta^{(n_u)}$ to small random values</li>
<li>Minimize J using gradient descent (or an advanced optimization algorithm)</li>
<li>For a user with parameters $\theta$ and a movie with (learned) features x, predict a star rating of $\theta^Tx$</li>
</ol>
</li>
</ul>
<h2 id="Low-Rank-Matrix-Factorization"><a href="#Low-Rank-Matrix-Factorization" class="headerlink" title="Low Rank Matrix Factorization"></a>Low Rank Matrix Factorization</h2><h3 id="Vectorization"><a href="#Vectorization" class="headerlink" title="Vectorization"></a>Vectorization</h3><ul>
<li><p>Given matrices X (each row containing features of a particular movie) and Θ (each row containing the weights for those features for a given user), then the full matrix Y of all predicted ratings of all movies by all users is given simply by: $Y = X\Theta^T$.</p>
</li>
<li><p>Predicting how similar two movies i and j are can be done using the distance between their respective feature vectors x. Specifically, we are looking for a small value of $||x^{(i)} - x^{(j)}||$.</p>
</li>
</ul>
<h3 id="Mean-Normalization"><a href="#Mean-Normalization" class="headerlink" title="Mean Normalization"></a>Mean Normalization</h3><p>If the ranking system for movies is used from the previous lectures, then new users (who have watched no movies), will be assigned new movies incorrectly. Specifically, they will be assigned θ with all components equal to zero due to the minimization of the regularization term. That is, we assume that the new user will rank all movies 0, which does not seem intuitively correct. 新用户会被预测为0</p>
<p>We rectify this problem by normalizing the data relative to the mean. First, we use a matrix Y to store the data from previous ratings, where the ith row of Y is the ratings for the ith movie and the jth column corresponds to the ratings for the jth user.</p>
<p>We can now define a vector</p>
<script type="math/tex; mode=display">
\mu  = [\mu_1, \mu_2, \dots , \mu_{n_m}]</script><p>such that</p>
<script type="math/tex; mode=display">
\mu_i = \frac{\sum_{j:r(i,j)=1}{Y_{i,j}}}{\sum_{j}{r(i,j)}}</script><p>Which is effectively the mean of the previous ratings for the ith movie (where only movies that have been watched by users are counted). We now can normalize the data by subtracting u, the mean rating, from the actual ratings for each user (column in matrix Y):</p>
<p>As an example, consider the following matrix Y and mean ratings μ:</p>
<script type="math/tex; mode=display">
Y=\left[\begin{array}{cccc}
5 & 5 & 0 & 0 \\
4 & ? & ? & 0 \\
0 & 0 & 5 & 4 \\
0 & 0 & 5 & 0
\end{array}\right], \quad \mu=\left[\begin{array}{c}
2.5 \\
2 \\
2.25 \\
1.25
\end{array}\right]</script><p>The resulting Y′ vector is:</p>
<script type="math/tex; mode=display">
Y^{\prime}=\left[\begin{array}{cccc}
2.5 & 2.5 & -2.5 & -2.5 \\
2 & ? & ? & -2 \\
-2 .25 & -2.25 & 3.75 & 1.25 \\
-1.25 & -1.25 & 3.75 & -1.25
\end{array}\right]</script><p>Now we must slightly modify the linear regression prediction to include the mean normalization term:</p>
<script type="math/tex; mode=display">
(\theta^{(j)})^T x^{(i)} + \mu_i</script><p>Now, for a new user, the initial predicted values will be equal to the μ term instead of simply being initialized to zero, which is more accurate.</p>
<blockquote>
<p>Note: 一般的均值归一化要除以range，即max-min，但是这里不需要，因为都有统一的scale</p>
</blockquote>

    </div>

    
    
    
      

  <div class="popular-posts-header">Related Posts</div>
  <ul class="related-posts">
  
      <li class="related-posts-item"><a href="/How-to-Win-a-Data-Science-Competition-Learn-from-Top-Kagglers/">How to Win a Data Science Competition</a></li>
  
      <li class="related-posts-item"><a href="/Machine-Learning-Week10/">Machine Learning Week10</a></li>
  
      <li class="related-posts-item"><a href="/Machine-Learning-Week06/">Machine Learning Week06</a></li>
  
      <li class="related-posts-item"><a href="/Machine-Learning-Week08/">Machine Learning Week08</a></li>
  
      <li class="related-posts-item"><a href="/Machine-Learning-Week07/">Machine Learning Week07</a></li>
  
  </ul>


    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>Jun XU
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://xuj14.github.io/Machine-Learning-Week09/" title="Machine Learning Week09">https://xuj14.github.io/Machine-Learning-Week09/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Machine-Learning/" rel="tag"><i class="fa fa-tag"></i> Machine Learning</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/Caculus-Review/" rel="prev" title="Caculus Review">
                  <i class="fa fa-chevron-left"></i> Caculus Review
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/Machine-Learning-Week10/" rel="next" title="Machine Learning Week10">
                  Machine Learning Week10 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jun XU</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>Symbols count total: </span>
    <span title="Symbols count total">72k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>Reading time total &asymp;</span>
    <span title="Reading time total">1:05</span>
  </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <script size="300" alpha="0.6" zIndex="-1" src="https://cdnjs.cloudflare.com/ajax/libs/ribbon.js/1.0.2/ribbon.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.0/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.2.8/pdfobject.min.js","integrity":"sha256-tu9j5pBilBQrWSDePOOajCUdz6hWsid/lBNzK4KgEPM="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js"></script>



  <script src="/js/third-party/pace.js"></script>

  


  <script class="next-config" data-name="leancloud_visitors" type="application/json">{"enable":true,"app_id":"Oe6lNLDUFdCT4aO5HYh597Om-MdYXbMMI","app_key":"2dnAg0FTC6n2hMWsLlwd2Ncj","server_url":"https://xuj14.github.io/","security":true}</script>
  <script src="/js/third-party/statistics/lean-analytics.js"></script>


  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true}});</script></body>
</html>
