<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/gallery/avator.svg">
  <link rel="icon" type="image/png" sizes="16x16" href="/gallery/avator.svg">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="Lr_u9ltNAl44yHB3jiDZo_D4g7u1IrCztvoySOZJeis">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/black/pace-theme-center-simple.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"xuj14.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.12.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Numpy | Pandas | re | SQL | matplotlib">
<meta property="og:type" content="article">
<meta property="og:title" content="Programming in Python (2)">
<meta property="og:url" content="https://xuj14.github.io/Programming-in-Python-2/index.html">
<meta property="og:site_name" content="午尹">
<meta property="og:description" content="Numpy | Pandas | re | SQL | matplotlib">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="c:/Users/junxu/OneDrive%20-%20Umich/Courses/Stats%20507/CourseNote2_files/CourseNote2_35_1.png">
<meta property="og:image" content="c:/Users/junxu/OneDrive%20-%20Umich/Courses/Stats%20507/CourseNote2_files/CourseNote2_43_1.png">
<meta property="og:image" content="c:/Users/junxu/OneDrive%20-%20Umich/Courses/Stats%20507/CourseNote2_files/CourseNote2_219_0.png">
<meta property="og:image" content="c:/Users/junxu/OneDrive%20-%20Umich/Courses/Stats%20507/CourseNote2_files/CourseNote2_222_0.png">
<meta property="og:image" content="c:/Users/junxu/OneDrive%20-%20Umich/Courses/Stats%20507/CourseNote2_files/CourseNote2_223_0.png">
<meta property="og:image" content="c:/Users/junxu/OneDrive%20-%20Umich/Courses/Stats%20507/CourseNote2_files/CourseNote2_224_1.png">
<meta property="article:published_time" content="2022-08-07T04:33:04.000Z">
<meta property="article:modified_time" content="2022-08-07T04:51:52.751Z">
<meta property="article:author" content="Jun XU">
<meta property="article:tag" content="Python">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="c:/Users/junxu/OneDrive%20-%20Umich/Courses/Stats%20507/CourseNote2_files/CourseNote2_35_1.png">


<link rel="canonical" href="https://xuj14.github.io/Programming-in-Python-2/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://xuj14.github.io/Programming-in-Python-2/","path":"Programming-in-Python-2/","title":"Programming in Python (2)"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Programming in Python (2) | 午尹</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-SJCKHPPPPQ"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-SJCKHPPPPQ","only_pageview":false}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end -->
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">午尹</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Quant</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">7</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">6</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">24</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#numpy"><span class="nav-number">1.</span> <span class="nav-text">Numpy</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#numpy.array"><span class="nav-number">1.1.</span> <span class="nav-text">numpy.array</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#arange"><span class="nav-number">1.2.</span> <span class="nav-text">arange()</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#array-indexing"><span class="nav-number">1.3.</span> <span class="nav-text">array indexing</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#example-minist"><span class="nav-number">1.3.1.</span> <span class="nav-text">Example: minist</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#numpyscipy-universal-functionsufuncs"><span class="nav-number">1.4.</span> <span class="nav-text">numpy&#x2F;scipy universal
functions(ufuncs)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#numpy-example"><span class="nav-number">1.5.</span> <span class="nav-text">Numpy example</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#pandas"><span class="nav-number">2.</span> <span class="nav-text">Pandas</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#basic-structures"><span class="nav-number">2.1.</span> <span class="nav-text">basic structures</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#series"><span class="nav-number">2.2.</span> <span class="nav-text">Series</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#dataframe"><span class="nav-number">2.3.</span> <span class="nav-text">DataFrame</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pipe-method-method-chaining"><span class="nav-number">2.4.</span> <span class="nav-text">pipe method: method
chaining</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#row--and-column-wise-function-apply"><span class="nav-number">2.5.</span> <span class="nav-text">row- and column-wise
function: apply()</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pandas-ii"><span class="nav-number">2.6.</span> <span class="nav-text">Pandas II</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pandasgroup-by"><span class="nav-number">2.7.</span> <span class="nav-text">pandas,Group By</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#matplotlib"><span class="nav-number">3.</span> <span class="nav-text">matplotlib</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#regular-expressions-and-text-encoding"><span class="nav-number">4.</span> <span class="nav-text">Regular Expressions and
Text Encoding</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#sql"><span class="nav-number">5.</span> <span class="nav-text">SQL</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#fetching-results"><span class="nav-number">5.1.</span> <span class="nav-text">Fetching results</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#parameterized-queries"><span class="nav-number">5.2.</span> <span class="nav-text">Parameterized queries</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#why-use-placeholders"><span class="nav-number">5.3.</span> <span class="nav-text">Why use placeholders</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ten-questions-about-flights"><span class="nav-number">6.</span> <span class="nav-text">Ten questions about
flights</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#which-airport-is-the-busiest"><span class="nav-number">6.1.</span> <span class="nav-text">Which airport is the busiest?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#which-month-was-coldest"><span class="nav-number">6.2.</span> <span class="nav-text">Which month was coldest?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#what-is-the-most-popular-carrier-at-each-of-the-three-nyc-airports"><span class="nav-number">6.3.</span> <span class="nav-text">What
is the most popular carrier at each of the three NYC airports?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#what-are-the-busiest-travel-weeks-of-the-year"><span class="nav-number">6.4.</span> <span class="nav-text">What are the
busiest travel weeks of the year?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#the-unix-epoch"><span class="nav-number">6.5.</span> <span class="nav-text">The Unix epoch</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#what-where-the-ten-worst-days-for-average-departure-delay"><span class="nav-number">6.6.</span> <span class="nav-text">What
where the ten worst days for average departure delay?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#what-where-the-ten-best-days-for-departure-delay"><span class="nav-number">6.7.</span> <span class="nav-text">What where the
ten best days for departure delay?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#what-airlines-have-the-most-departure-delay"><span class="nav-number">6.8.</span> <span class="nav-text">What airlines have
the most departure delay?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#what-airplane-flew-the-most-days"><span class="nav-number">6.9.</span> <span class="nav-text">What airplane flew the most
days?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#how-many-flights-were-cancelled"><span class="nav-number">6.10.</span> <span class="nav-text">How many flights were
cancelled?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#how-many-flights-were-destined-for-airports-with-a-one-word-name"><span class="nav-number">6.11.</span> <span class="nav-text">How
many flights were destined for airports with a one word name?</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Jun XU"
      src="/gallery/avator.jpg">
  <p class="site-author-name" itemprop="name">Jun XU</p>
  <div class="site-description" itemprop="description">Financial Engineering | Machine Learning</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">24</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/xuJ14" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;xuJ14" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:jun.xu14@gmail.com" title="E-Mail → mailto:jun.xu14@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/xuJ14" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://xuj14.github.io/Programming-in-Python-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/gallery/avator.jpg">
      <meta itemprop="name" content="Jun XU">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="午尹">
      <meta itemprop="description" content="Financial Engineering | Machine Learning">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Programming in Python (2) | 午尹">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Programming in Python (2)
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2022-08-07 00:33:04 / Modified: 00:51:52" itemprop="dateCreated datePublished" datetime="2022-08-07T00:33:04-04:00">2022-08-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Programming/" itemprop="url" rel="index"><span itemprop="name">Programming</span></a>
        </span>
    </span>

  
    <span id="/Programming-in-Python-2/" class="post-meta-item leancloud_visitors" data-flag-title="Programming in Python (2)" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>45k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>41 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="numpy">Numpy</h1>
<ul>
<li>Built on Numpy:
<ul>
<li>SciPy</li>
<li>Pandas</li>
<li>matplotlib</li>
<li>Tensorflow</li>
<li>Scikit Learn</li>
<li>PyTorch</li>
<li>JAX</li>
</ul></li>
<li>Numpy quick start guide:
https://numpy.org/doc/stable/user/quickstart.html</li>
<li>closely related package <code>scipy</code> is for opimization</li>
<li>Basic numerical data types:
<ul>
<li>bool</li>
<li>int</li>
<li>uint</li>
<li>float</li>
<li>complex</li>
<li>https://docs.scipy.org/doc/numpy-1.10.1/user/basics.types.html</li>
</ul></li>
</ul>
<h2 id="numpy.array"><code>numpy.array</code></h2>
<ul>
<li>https://docs.scipy.org/doc/numpy-1.10.1/user/basics.creation.html</li>
<li>compared to list:
<ul>
<li>faster</li>
<li>operation easy</li>
</ul></li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],dtype=<span class="string">'uint'</span>)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([1, 2, 3], dtype=uint32)</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.zeros((<span class="number">2</span>,<span class="number">3</span>))</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([[0., 0., 0.],
       [0., 0., 0.]])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.arange(<span class="number">2</span>,<span class="number">3</span>,<span class="number">0.1</span>,dtype=<span class="string">'float'</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([2. , 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9])</code></pre>
<p>小心大整数会导致数据溢出，不同机器结果不一样</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">a = np.arange(<span class="number">100_000_000</span>,dtype=<span class="string">'int64'</span>)</span><br><span class="line">np.<span class="built_in">sum</span>(a)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>4999999950000000</code></pre>
<p>empty 有时候会有随机结果，容易出错</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.empty((<span class="number">2</span>,<span class="number">3</span>))</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([[0., 0., 0.],
       [0., 0., 0.]])</code></pre>
<h2 id="arange"><code>arange()</code></h2>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.arange(<span class="number">27</span>).reshape(<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([[[ 0,  1,  2],
        [ 3,  4,  5],
        [ 6,  7,  8]],

       [[ 9, 10, 11],
        [12, 13, 14],
        [15, 16, 17]],

       [[18, 19, 20],
        [21, 22, 23],
        [24, 25, 26]]])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = np.arange(<span class="number">27</span>).reshape(<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>)</span><br><span class="line">a[<span class="number">0</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([[0, 1, 2],
       [3, 4, 5],
       [6, 7, 8]])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.arange(<span class="number">5</span>,<span class="number">10</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([5, 6, 7, 8, 9])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.arange(<span class="number">0</span>,<span class="number">1</span>,<span class="number">0.1</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([0. , 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9])</code></pre>
<h2 id="array-indexing">array indexing</h2>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x=np.arange(<span class="number">10</span>)</span><br><span class="line">x</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x[:-<span class="number">2</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([0, 1, 2, 3, 4, 5, 6, 7])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x[<span class="number">1</span>:<span class="number">7</span>:<span class="number">2</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([1, 3, 5])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x[::<span class="number">2</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([0, 2, 4, 6, 8])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x = np.reshape(np.arange(<span class="number">1</span>,<span class="number">13</span>),(<span class="number">3</span>,<span class="number">4</span>))</span><br><span class="line">x</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([[ 1,  2,  3,  4],
       [ 5,  6,  7,  8],
       [ 9, 10, 11, 12]])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x[<span class="number">1</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([5, 6, 7, 8])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x[:,(<span class="number">1</span>,<span class="number">3</span>)]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([[ 2,  4],
       [ 6,  8],
       [10, 12]])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x[(<span class="number">0</span>,<span class="number">2</span>),(<span class="number">1</span>,<span class="number">3</span>)] <span class="comment"># 表示（0，1）和（2，3），第二项表示第几列，第一项表示第几行</span></span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([ 2, 12])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x[x&gt;<span class="number">7</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([ 8,  9, 10, 11, 12])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x[(<span class="literal">True</span>,<span class="literal">False</span>,<span class="literal">False</span>)]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([], shape=(0, 2, 5), dtype=int32)</code></pre>
<ul>
<li>index 组合可以用np.ix_</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x = np.arange(<span class="number">9</span>).reshape(<span class="number">3</span>,<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line">x[np.ix_([<span class="number">0</span>,<span class="number">2</span>],[<span class="number">0</span>,<span class="number">1</span>])]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>[[0 1 2]
 [3 4 5]
 [6 7 8]]





array([[0, 1],
       [6, 7]])</code></pre>
<h3 id="example-minist">Example: minist</h3>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">minist = np.load(<span class="string">'8/mnist.npz'</span>)</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">minist[<span class="string">'images'</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]], dtype=uint8)</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span>(minist) <span class="comment"># get key</span></span><br></pre></td></tr></tbody></table></figure>
<pre><code>['images', 'labels']</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">minist[<span class="string">'images'</span>].ndim</span><br></pre></td></tr></tbody></table></figure>
<pre><code>2</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">minist[<span class="string">'images'</span>].shape</span><br></pre></td></tr></tbody></table></figure>
<pre><code>(60000, 784)</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">img = minist[<span class="string">'images'</span>]</span><br><span class="line">img[<span class="number">0</span>].shape <span class="comment"># 一维</span></span><br></pre></td></tr></tbody></table></figure>
<pre><code>(784,)</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">img_0 = img[<span class="number">0</span>].reshape(<span class="number">28</span>,<span class="number">28</span>)</span><br><span class="line"></span><br><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">plt.imshow(img_0,cmap=<span class="string">"Greys"</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>&lt;matplotlib.image.AxesImage at 0x2d675185120&gt;</code></pre>
<p>​<br>
<img src="C:/Users/junxu/OneDrive%20-%20Umich/Courses/Stats%20507/CourseNote2_files/CourseNote2_35_1.png" alt="png"> ​</p>
<p>mnist中的数据按照uint8存储，所以加和是错误的</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.uint8(<span class="number">255</span>).astype(<span class="built_in">int</span>).dtype</span><br></pre></td></tr></tbody></table></figure>
<pre><code>dtype('int32')</code></pre>
<h2 id="numpyscipy-universal-functionsufuncs">numpy/scipy universal
functions(ufuncs)</h2>
<ul>
<li>support vectorized operations</li>
<li><code>np.min</code>快于<code>min</code>,<code>max</code></li>
<li></li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sum</span>(img.reshape(<span class="built_in">len</span>(img),<span class="number">28</span>,<span class="number">28</span>)).shape</span><br></pre></td></tr></tbody></table></figure>
<pre><code>(28, 28)</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.mean(img)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>33.318421449829934</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">img.reshape(-<span class="number">1</span>).shape</span><br></pre></td></tr></tbody></table></figure>
<pre><code>(47040000,)</code></pre>
<p>按照维度相加</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plt.imshow(img[minist[<span class="string">'labels'</span>]==<span class="number">8</span>].mean(axis=<span class="number">0</span>).reshape(<span class="number">28</span>,<span class="number">28</span>))</span><br></pre></td></tr></tbody></table></figure>
<pre><code>&lt;matplotlib.image.AxesImage at 0x2d675301ab0&gt;</code></pre>
<p>​<br>
<img src="C:/Users/junxu/OneDrive%20-%20Umich/Courses/Stats%20507/CourseNote2_files/CourseNote2_43_1.png" alt="png"> ​</p>
<h2 id="numpy-example">Numpy example</h2>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">salaries_full = pd.read_csv(</span><br><span class="line">    <span class="string">"9/salaries_clean.csv"</span>, encoding=<span class="string">"latin1"</span>, index_col=<span class="string">"salary_id"</span></span><br><span class="line">)</span><br><span class="line">columns = [</span><br><span class="line">    <span class="string">"location_latitude"</span>,</span><br><span class="line">    <span class="string">"location_longitude"</span>,</span><br><span class="line">    <span class="string">"total_experience_years"</span>,</span><br><span class="line">    <span class="string">"employer_experience_years"</span>,</span><br><span class="line">    <span class="string">"annual_base_pay"</span>,</span><br><span class="line">    <span class="string">"signing_bonus"</span>,</span><br><span class="line">]</span><br><span class="line">salary_data = salaries_full[columns].to_numpy()</span><br><span class="line">salary_data</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([[ 3.7770e+01, -1.2241e+02,  1.3000e+01,  2.0000e+00,  1.2500e+05,
         5.0000e+03],
       [ 3.6360e+01, -9.4200e+01,  1.5000e+01,  8.0000e+00,  6.5000e+04,
                nan],
       [ 4.1470e+01, -8.1670e+01,  4.0000e+00,  1.0000e+00,  8.6000e+04,
         5.0000e+03],
       ...,
       [        nan,         nan,  7.0000e+00,  1.0000e+00,  1.5000e+05,
         0.0000e+00],
       [ 3.8990e+01, -7.6930e+01,  5.0000e+00,  1.0000e+00,  7.5000e+04,
                nan],
       [        nan,         nan,  2.0000e+00,  0.0000e+00,  5.0000e+01,
         0.0000e+00]])</code></pre>
<p>Numpy indexing conventirons:</p>
<ul>
<li>outermost,innermost</li>
<li></li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">salary_data[:,<span class="number">0</span>].shape</span><br></pre></td></tr></tbody></table></figure>
<pre><code>(1655,)</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">col = np.array(columns)</span><br><span class="line">col==<span class="string">'annual_base_pay'</span></span><br><span class="line">annual_base_pay = salary_data[:,col==<span class="string">'annual_base_pay'</span>] </span><br><span class="line">np.mean(annual_base_pay)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>nan</code></pre>
<ul>
<li>index 可以boolean</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.nanmean(annual_base_pay)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>6325003.746965475</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.isnan(annual_base_pay)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([[False],
       [False],
       [False],
       ...,
       [False],
       [False],
       [False]])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">annual_base_pay.reshape(-<span class="number">1</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([1.25e+05, 6.50e+04, 8.60e+04, ..., 1.50e+05, 7.50e+04, 5.00e+01])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">annual_base_pay[np.isnan(annual_base_pay)]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([nan, nan, nan, nan])</code></pre>
<ul>
<li>取反</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~np.isnan(annual_base_pay)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([[ True],
       [ True],
       [ True],
       ...,
       [ True],
       [ True],
       [ True]])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">np.<span class="built_in">all</span>(~np.isnan(salary_data),axis=<span class="number">1</span>)</span><br><span class="line">np.<span class="built_in">any</span>(np.isnan(salary_data),axis=<span class="number">1</span>)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([False,  True, False, ...,  True,  True,  True])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">salary_data[~np.<span class="built_in">any</span>(np.isnan(salary_data),axis=<span class="number">1</span>)]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([[ 3.7770e+01, -1.2241e+02,  1.3000e+01,  2.0000e+00,  1.2500e+05,
         5.0000e+03],
       [ 4.1470e+01, -8.1670e+01,  4.0000e+00,  1.0000e+00,  8.6000e+04,
         5.0000e+03],
       [ 3.8000e+01, -9.7000e+01,  5.0000e+00,  1.5000e+00,  4.0000e+04,
         0.0000e+00],
       ...,
       [ 4.0030e+01, -7.5630e+01,  2.0000e+00,  1.0000e+00,  6.0000e+04,
         0.0000e+00],
       [ 3.9950e+01, -7.5160e+01,  6.0000e+00,  2.5000e+00,  1.1100e+05,
         5.0000e+03],
       [ 4.0020e+01, -1.0525e+02,  1.0000e+00,  5.0000e-01,  6.0500e+04,
         0.0000e+00]])</code></pre>
<ul>
<li>last 2 rows</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">salary_data[-<span class="number">2</span>:]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([[ 3.899e+01, -7.693e+01,  5.000e+00,  1.000e+00,  7.500e+04,
               nan],
       [       nan,        nan,  2.000e+00,  0.000e+00,  5.000e+01,
         0.000e+00]])</code></pre>
<ul>
<li>list 是行的index</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">salary_data[[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([[ 3.636e+01, -9.420e+01,  1.500e+01,  8.000e+00,  6.500e+04,
               nan],
       [ 4.147e+01, -8.167e+01,  4.000e+00,  1.000e+00,  8.600e+04,
         5.000e+03],
       [       nan,        nan,  4.000e+00,  0.000e+00,  1.050e+05,
         5.000e+03]])</code></pre>
<ul>
<li>tuple 是坐标</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># salary_data[(1,2,3)] # Error: () 代表坐标</span></span><br><span class="line">salary_data[(<span class="number">1</span>,<span class="number">2</span>)]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>15.0</code></pre>
<p>Normalizing Data</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">col_mean = np.nanmean(salary_data,axis=<span class="number">0</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([ 3.77543939e+01, -6.47122727e+01,  6.75611318e+00,  2.65616294e+00,
        6.32500375e+06,  2.24056269e+04])</code></pre>
<ul>
<li>Broad casting</li>
</ul>
<p>Note: 如果矩阵很大，可能会溢出，这样就得用for loop来写</p>
<p>Broad cast的矩阵，要么某些维度数量match，要么就是1或没有</p>
<ul>
<li><span class="math inline">\(5\times4\)</span> ; 1</li>
<li><span class="math inline">\(5\times4\)</span> ; 4</li>
<li>但是<span class="math inline">\(5\times4\)</span>如果要每行减去一列数字，不能是一个长度为5的array，因为匹配的是innermost
index，应该reshape(1,5) 或者
<code>[:,None]</code>即最后加一个维度=1</li>
<li></li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">salary_data.mean(<span class="number">1</span>)</span><br><span class="line">salary_data.mean(axis=<span class="number">1</span>) <span class="comment"># mean of each row</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([21655.06,      nan, 15160.8 , ...,      nan,      nan,      nan])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">row_mu = salary_data.mean(axis=<span class="number">1</span>)</span><br><span class="line">row_mu.shape,row_mu[:,<span class="literal">None</span>].shape,row_mu[:,<span class="literal">None</span>,<span class="literal">None</span>].shape</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>((1655,), (1655, 1), (1655, 1, 1))</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">salary_data-row_mu[:,<span class="literal">None</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([[-21617.29, -21777.47, -21642.06, -21653.06, 103344.94, -16655.06],
       [      nan,       nan,       nan,       nan,       nan,       nan],
       [-15119.33, -15242.47, -15156.8 , -15159.8 ,  70839.2 , -10160.8 ],
       ...,
       [      nan,       nan,       nan,       nan,       nan,       nan],
       [      nan,       nan,       nan,       nan,       nan,       nan],
       [      nan,       nan,       nan,       nan,       nan,       nan]])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.array(<span class="number">1</span>).shape,np.array(<span class="number">1</span>)[<span class="literal">None</span>].shape</span><br></pre></td></tr></tbody></table></figure>
<pre><code>((), (1,))</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">row_mu = salary_data.mean(axis=<span class="number">1</span>,keepdims=<span class="literal">True</span>)</span><br><span class="line">row_mu.shape</span><br></pre></td></tr></tbody></table></figure>
<pre><code>(1655, 1)</code></pre>
<ul>
<li>Reductions and <code>axis=</code>
<ul>
<li>that axis will disapear</li>
</ul></li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">salary_data.mean(axis=<span class="number">1</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([21655.06,      nan, 15160.8 , ...,      nan,      nan,      nan])</code></pre>
<p><code>for</code> loops too slow</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">prices = np.array([<span class="number">20</span>,<span class="number">18</span>,<span class="number">21</span>,<span class="number">14</span>])</span><br><span class="line">prices - np.minimum.accumulate(prices)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([0, 0, 3, 0])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">10</span></span><br><span class="line">p = <span class="number">2</span></span><br><span class="line">k = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">x = np.random.rand(n,p)</span><br><span class="line">c = np.random.rand(k,p)</span><br><span class="line">x.shape</span><br></pre></td></tr></tbody></table></figure>
<pre><code>(10, 2)</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([[0.57019677, 0.43860151],
       [0.98837384, 0.10204481],
       [0.20887676, 0.16130952],
       [0.65310833, 0.2532916 ],
       [0.46631077, 0.24442559],
       [0.15896958, 0.11037514],
       [0.65632959, 0.13818295],
       [0.19658236, 0.36872517],
       [0.82099323, 0.09710128],
       [0.83794491, 0.09609841]])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.random.rand(<span class="number">10</span>,<span class="number">2</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([[0.58651293, 0.02010755],
       [0.82894003, 0.00469548],
       [0.67781654, 0.27000797],
       [0.73519402, 0.96218855],
       [0.24875314, 0.57615733],
       [0.59204193, 0.57225191],
       [0.22308163, 0.95274901],
       [0.44712538, 0.84640867],
       [0.69947928, 0.29743695],
       [0.81379782, 0.39650574]])</code></pre>
<ul>
<li>(n,1,p)-(1,k,p)是一个(n,k,p)的array</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">D = x[:,<span class="literal">None</span>,:]-c[<span class="literal">None</span>,:]</span><br><span class="line">D[<span class="number">0</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([[-0.40626269, -0.03004969],
       [-0.40656432, -0.16624401],
       [-0.16906681,  0.39941372]])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D.shape</span><br></pre></td></tr></tbody></table></figure>
<pre><code>(10, 3, 2)</code></pre>
<ul>
<li>第三个维度被reduction</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x_c_norm = np.linalg.norm(D,axis=<span class="number">2</span>)</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.argmin(x_c_norm,axis=<span class="number">1</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([0, 2, 2, 2, 2, 2, 2, 2, 2, 2], dtype=int64)</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">k=<span class="number">3</span></span><br><span class="line">a= np.array([<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>])</span><br><span class="line">ans = a[:,<span class="literal">None</span>]+a[<span class="literal">None</span>,:]</span><br><span class="line">ans[:<span class="built_in">len</span>(a)-k+<span class="number">1</span>,:k]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([[0, 1, 2],
       [1, 2, 3],
       [2, 3, 4],
       [3, 4, 5]])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x = np.arange(<span class="number">10</span>)</span><br><span class="line">x[np.logical_and(x&gt;<span class="number">3</span>,x&lt;<span class="number">7</span>)]</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([4, 5, 6])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x[np.logical_or(x&gt;<span class="number">3</span>,x&lt;<span class="number">7</span>)]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">np.random.random((<span class="number">2</span>,<span class="number">3</span>))</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([[0.8754406 , 0.31234192, 0.21472602],
       [0.1417056 , 0.6179606 , 0.0532995 ]])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">np.random.normal(<span class="number">0</span>,<span class="number">1</span>,<span class="number">20</span>)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([ 1.36952814,  0.39363222,  0.48644709, -0.23743297,  0.21279548,
       -0.5515374 , -2.22034906, -1.41651274,  0.08532262,  0.49804278,
       -2.03253663,  0.66368554,  0.28155033,  0.94521731,  0.5938768 ,
       -1.57368613, -1.55284648,  0.54146951, -0.75257585, -0.23976487])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.random.uniform(<span class="number">0</span>,<span class="number">1</span>,(<span class="number">2</span>,<span class="number">4</span>))</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([[0.5909873 , 0.8235658 , 0.14703172, 0.94326283],
       [0.79080321, 0.34115745, 0.75083531, 0.31725324]])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">x=np.arange(<span class="number">1</span>,<span class="number">11</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    <span class="built_in">print</span>(np.random.choice(x,<span class="number">5</span>,<span class="literal">False</span>,x/<span class="built_in">float</span>(<span class="built_in">sum</span>(x))))</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>[ 6 10  7  9  5]
[ 9  8 10  7  6]
[ 2  8  9 10  5]
[10  9  8  3  6]
[7 8 6 5 9]</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x = np.arange(<span class="number">10</span>)</span><br><span class="line">np.random.shuffle(x)</span><br><span class="line">x</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([1, 7, 4, 0, 8, 3, 5, 2, 6, 9])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.random.permutation(x) <span class="comment">#x not change</span></span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([1, 9, 5, 7, 3, 4, 2, 0, 6, 8])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([1, 7, 4, 0, 8, 3, 5, 2, 6, 9])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.sort(x)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</code></pre>
<h1 id="pandas">Pandas</h1>
<h2 id="basic-structures">basic structures</h2>
<ul>
<li>Series
<ul>
<li>One dimensional labeled array</li>
</ul></li>
<li>DataFrame
<ul>
<li>tabel of rows, with labeled columns</li>
<li></li>
</ul></li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">a= np.array([<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>])</span><br><span class="line">(a[:,<span class="literal">None</span>]+a[<span class="literal">None</span>,:])[:<span class="number">4</span>,:<span class="number">3</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([[0, 1, 2],
       [1, 2, 3],
       [2, 3, 4],
       [3, 4, 5]])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">flight = pd.read_csv(<span class="string">"10/flights.csv.gz"</span>)</span><br></pre></td></tr></tbody></table></figure>
<h2 id="series"><code>Series</code></h2>
<ul>
<li>can create a pandas series from any array-like structure(dict,numpy
array,list)</li>
<li>和numpy不同的是：有label
<ul>
<li>可以自己改label</li>
</ul></li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">numbers = np.random.randn(<span class="number">5</span>)</span><br><span class="line">s = pd.Series(numbers)</span><br><span class="line">s</span><br></pre></td></tr></tbody></table></figure>
<pre><code>0    1.556860
1    0.187127
2   -0.245997
3    1.342677
4   -0.117419
dtype: float64</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">idx = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>]</span><br><span class="line">s = pd.Series(numbers,index=idx)</span><br><span class="line">s</span><br></pre></td></tr></tbody></table></figure>
<pre><code>a    1.556860
b    0.187127
c   -0.245997
d    1.342677
e   -0.117419
dtype: float64</code></pre>
<blockquote>
<p>providing too few or too many indices is a ValueError</p>
</blockquote>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.Series(np.random.rand(<span class="number">5</span>),index=[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>])</span><br></pre></td></tr></tbody></table></figure>
<pre><code>a    0.996875
b    0.893754
c    0.925473
d    0.853753
e    0.500225
dtype: float64</code></pre>
<blockquote>
<p>can create a Series from a dict</p>
</blockquote>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d = {<span class="string">"dog"</span>:<span class="number">1</span>,<span class="string">"cat"</span>:<span class="number">2</span>}</span><br><span class="line">pd.Series(d)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>dog    1
cat    2
dtype: int64</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.Series(d,index=[<span class="string">"dog"</span>,<span class="string">"cat"</span>,<span class="string">"pig"</span>])</span><br></pre></td></tr></tbody></table></figure>
<pre><code>dog    1.0
cat    2.0
pig    NaN
dtype: float64</code></pre>
<p>字典里没有pig，所以这里赋值给pig：NaN</p>
<p>inf==inf+X</p>
<p>np.nan不等于np.nan</p>
<p>用np.isnan()判断</p>
<p>或者用变量不等于自身判断nan，这是一个变量不等于自身的特例</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s[<span class="number">0</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>1.5568595147700188</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s[-<span class="number">1</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>-0.11741940757185318</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s[:<span class="number">3</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>a    1.556860
b    0.187127
c   -0.245997
dtype: float64</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s[<span class="string">'a'</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>1.5568595147700188</code></pre>
<blockquote>
<p>这里需要注意的是：用:以及index名字分割数组时，:后面的也会包含进去。但是数字不会,哪怕索引名字是数字。</p>
</blockquote>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s[<span class="string">'a'</span>:<span class="string">'c'</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>a    1.556860
b    0.187127
c   -0.245997
dtype: float64</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s[<span class="number">0</span>:<span class="number">3</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>a    1.556860
b    0.187127
c   -0.245997
dtype: float64</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.exp(s[:<span class="number">3</span>])</span><br></pre></td></tr></tbody></table></figure>
<pre><code>a    4.743900
b    1.205781
c    0.781924
dtype: float64</code></pre>
<ul>
<li>indices need not be unique</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s = pd.Series([<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>],index=[<span class="string">'a'</span>,<span class="string">'a'</span>,<span class="string">'a'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>])</span><br><span class="line">s</span><br></pre></td></tr></tbody></table></figure>
<pre><code>a     2
a     3
a     5
c     7
d    11
dtype: int64</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s[<span class="string">'a'</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>a    2
a    3
a    5
dtype: int64</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s[<span class="number">0</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>2</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s[<span class="string">'a'</span>:<span class="string">'c'</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>a    2
a    3
a    5
c    7
dtype: int64</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s[<span class="number">0</span>:<span class="number">3</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>a    2
a    3
a    5
dtype: int64</code></pre>
<blockquote>
<p>和np一样，可以用boolean series索引</p>
</blockquote>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s[s&gt;<span class="number">5</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>c     7
d    11
dtype: int64</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s&gt;<span class="number">5</span></span><br></pre></td></tr></tbody></table></figure>
<pre><code>a    False
a    False
a    False
c     True
d     True
dtype: bool</code></pre>
<p>Series objects are dict-like, in that we can access and update
entries via their keys.</p>
<p>Like dictionary, accessing a non-existent key is a KeyError.</p>
<p>Series also support <code>in</code> operator.</p>
<p>also support <code>get</code> method in dictionary</p>
<p>entries in Series can be mix type, but no sequence</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s.name = <span class="string">"random int"</span></span><br><span class="line">s</span><br></pre></td></tr></tbody></table></figure>
<pre><code>a     2
a     3
a     5
c     7
d    11
Name: random int, dtype: int64</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s = pd.Series([<span class="string">'dog'</span>,<span class="string">'fish'</span>,<span class="string">'elephant'</span>])</span><br><span class="line">s.<span class="built_in">map</span>(<span class="keyword">lambda</span> s:<span class="built_in">len</span>(s))</span><br></pre></td></tr></tbody></table></figure>
<pre><code>0    3
1    4
2    8
dtype: int64</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s.<span class="built_in">map</span>(<span class="built_in">len</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>0    3
1    4
2    8
dtype: int64</code></pre>
<blockquote>
<p><code>map</code> in Series allows to change values based on another
Series.</p>
</blockquote>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s = pd.Series([<span class="string">'fruit'</span>,<span class="string">'animal'</span>,<span class="string">'animal'</span>,<span class="string">'fruit'</span>,<span class="string">'fruit'</span>],index=[<span class="string">'apple'</span>,<span class="string">'cat'</span>,<span class="string">'goat'</span>,<span class="string">'banana'</span>,<span class="string">'kiwi'</span>])</span><br><span class="line">s</span><br></pre></td></tr></tbody></table></figure>
<pre><code>apple      fruit
cat       animal
goat      animal
banana     fruit
kiwi       fruit
dtype: object</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">t = pd.Series({<span class="string">'fruit'</span>:<span class="number">0</span>,<span class="string">'animal'</span>:<span class="number">1</span>})</span><br><span class="line">s.<span class="built_in">map</span>(t)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>apple     0
cat       1
goat      1
banana    0
kiwi      0
dtype: int64</code></pre>
<h2 id="dataframe">DataFrame</h2>
<ul>
<li>each column can have its own index. DataFrame will have all the
index. 缺失值NaN</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">d = {<span class="string">'A'</span>:pd.Series([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],index={<span class="string">'cat'</span>,<span class="string">'dog'</span>,<span class="string">'bird'</span>}),<span class="string">'B'</span>:{<span class="string">'dog'</span>:<span class="number">1</span>,<span class="string">'cat'</span>:<span class="number">2</span>,<span class="string">'bird'</span>:<span class="number">3</span>,<span class="string">'goat'</span>:<span class="number">4</span>}}</span><br><span class="line">df = pd.DataFrame(d)</span><br><span class="line">df</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
A
</th>
<th>
B
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
bird
</th>
<td>
2.0
</td>
<td>
3
</td>
</tr>
<tr>
<th>
cat
</th>
<td>
3.0
</td>
<td>
2
</td>
</tr>
<tr>
<th>
dog
</th>
<td>
1.0
</td>
<td>
1
</td>
</tr>
<tr>
<th>
goat
</th>
<td>
NaN
</td>
<td>
4
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'A'</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>bird    2.0
cat     3.0
dog     1.0
goat    NaN
Name: A, dtype: float64</code></pre>
<p>By default: rows and columns are ordered alphabetically</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.columns</span><br></pre></td></tr></tbody></table></figure>
<pre><code>Index(['A', 'B'], dtype='object')</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.index</span><br></pre></td></tr></tbody></table></figure>
<pre><code>Index(['bird', 'cat', 'dog', 'goat'], dtype='object')</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'C'</span>]=df[<span class="string">'A'</span>]*<span class="number">2</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
A
</th>
<th>
B
</th>
<th>
C
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
bird
</th>
<td>
2.0
</td>
<td>
3
</td>
<td>
4.0
</td>
</tr>
<tr>
<th>
cat
</th>
<td>
3.0
</td>
<td>
2
</td>
<td>
6.0
</td>
</tr>
<tr>
<th>
dog
</th>
<td>
1.0
</td>
<td>
1
</td>
<td>
2.0
</td>
</tr>
<tr>
<th>
goat
</th>
<td>
NaN
</td>
<td>
4
</td>
<td>
NaN
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flight[<span class="string">'max_delay'</span>]=<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">max</span>,flight[<span class="string">'arr_delay'</span>],flight[<span class="string">'dep_delay'</span>]))</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>])</span><br><span class="line">np.maximum(v,v*<span class="number">2</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([ 2,  4,  6,  8, 10])</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.<span class="built_in">max</span>(v)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>5</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flight[<span class="string">'max_delay'</span>] = np.maximum(flight[<span class="string">'arr_delay'</span>],flight[<span class="string">'dep_delay'</span>])</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">flight[<span class="string">'num'</span>]=<span class="number">0</span> <span class="comment"># Broadcast</span></span><br><span class="line">flight[<span class="string">'num'</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>0         0
1         0
2         0
3         0
4         0
         ..
336771    0
336772    0
336773    0
336774    0
336775    0
Name: num, Length: 336776, dtype: int64</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">del</span> flight[<span class="string">'num'</span>]</span><br><span class="line">flight.columns</span><br></pre></td></tr></tbody></table></figure>
<pre><code>Index(['year', 'month', 'day', 'dep_time', 'sched_dep_time', 'dep_delay',
       'arr_time', 'sched_arr_time', 'arr_delay', 'carrier', 'flight',
       'tailnum', 'origin', 'dest', 'air_time', 'distance', 'hour', 'minute',
       'time_hour', 'max_delay'],
      dtype='object')</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[<span class="string">'cat'</span>] <span class="comment"># select rows by labels</span></span><br></pre></td></tr></tbody></table></figure>
<pre><code>A    3.0
B    2.0
Name: cat, dtype: float64</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[<span class="number">1</span>] <span class="comment"># select rows by their integer labels(starting from 0)</span></span><br></pre></td></tr></tbody></table></figure>
<pre><code>A    3.0
B    2.0
Name: cat, dtype: float64</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="number">1</span>:<span class="number">3</span>] <span class="comment"># rows</span></span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
A
</th>
<th>
B
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
cat
</th>
<td>
3.0
</td>
<td>
2
</td>
</tr>
<tr>
<th>
dog
</th>
<td>
1.0
</td>
<td>
1
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[df[<span class="string">'A'</span>]&gt;<span class="number">2</span>]</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
A
</th>
<th>
B
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
cat
</th>
<td>
3.0
</td>
<td>
2
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[:<span class="number">2</span>,:<span class="number">1</span>] <span class="comment"># 这里无法去掉iloc</span></span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
A
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
bird
</th>
<td>
2.0
</td>
</tr>
<tr>
<th>
cat
</th>
<td>
3.0
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[<span class="string">'cat'</span>:<span class="string">'dog'</span>,<span class="string">'A'</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>cat    3.0
dog    1.0
Name: A, dtype: float64</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df1 = pd.DataFrame(np.random.randn(<span class="number">8</span>,<span class="number">4</span>),columns=[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>])</span><br><span class="line">df2 = pd.DataFrame(np.random.randn(<span class="number">5</span>,<span class="number">3</span>),columns=[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>])</span><br><span class="line">df1+df2</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
a
</th>
<th>
b
</th>
<th>
c
</th>
<th>
d
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
0.150499
</td>
<td>
-0.084967
</td>
<td>
-1.304810
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
1
</th>
<td>
-1.723753
</td>
<td>
0.809527
</td>
<td>
-3.027434
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
2
</th>
<td>
-1.770957
</td>
<td>
-1.115960
</td>
<td>
-0.606153
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
3
</th>
<td>
-1.322787
</td>
<td>
-0.154228
</td>
<td>
0.316819
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
4
</th>
<td>
0.357720
</td>
<td>
2.129364
</td>
<td>
2.252070
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
5
</th>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
6
</th>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
7
</th>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df2-df2.iloc[<span class="number">0</span>] <span class="comment"># Broadcast</span></span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
a
</th>
<th>
b
</th>
<th>
c
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
</tr>
<tr>
<th>
1
</th>
<td>
-0.406540
</td>
<td>
-0.015429
</td>
<td>
-0.683493
</td>
</tr>
<tr>
<th>
2
</th>
<td>
-0.095646
</td>
<td>
-1.092577
</td>
<td>
1.542312
</td>
</tr>
<tr>
<th>
3
</th>
<td>
-0.462943
</td>
<td>
-0.349725
</td>
<td>
1.856521
</td>
</tr>
<tr>
<th>
4
</th>
<td>
0.749604
</td>
<td>
1.157111
</td>
<td>
1.999972
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(df1&gt;<span class="number">0.5</span>).<span class="built_in">any</span>()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>a    True
b    True
c    True
d    True
dtype: bool</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(df1&gt;<span class="number">0.5</span>).<span class="built_in">all</span>()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>a    False
b    False
c    False
d    False
dtype: bool</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.T*df1.T</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
0
</th>
<th>
1
</th>
<th>
2
</th>
<th>
3
</th>
<th>
4
</th>
<th>
5
</th>
<th>
6
</th>
<th>
7
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
a
</th>
<td>
0.039975
</td>
<td>
1.607250
</td>
<td>
2.643456
</td>
<td>
0.656756
</td>
<td>
0.117268
</td>
<td>
0.264463
</td>
<td>
0.471706
</td>
<td>
1.462087
</td>
</tr>
<tr>
<th>
b
</th>
<td>
0.012506
</td>
<td>
0.636951
</td>
<td>
0.002525
</td>
<td>
0.028437
</td>
<td>
0.893762
</td>
<td>
2.970262
</td>
<td>
0.084393
</td>
<td>
3.932983
</td>
</tr>
<tr>
<th>
c
</th>
<td>
0.002420
</td>
<td>
1.184460
</td>
<td>
0.797188
</td>
<td>
0.080707
</td>
<td>
2.273190
</td>
<td>
0.834139
</td>
<td>
2.697453
</td>
<td>
0.488765
</td>
</tr>
<tr>
<th>
d
</th>
<td>
0.650234
</td>
<td>
0.199167
</td>
<td>
0.196074
</td>
<td>
0.403005
</td>
<td>
0.352569
</td>
<td>
1.245693
</td>
<td>
0.628392
</td>
<td>
0.021431
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.T.dot(df1) <span class="comment"># numpy-like</span></span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
a
</th>
<th>
b
</th>
<th>
c
</th>
<th>
d
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
a
</th>
<td>
7.262961
</td>
<td>
-4.896682
</td>
<td>
2.348484
</td>
<td>
-2.077213
</td>
</tr>
<tr>
<th>
b
</th>
<td>
-4.896682
</td>
<td>
8.561819
</td>
<td>
3.042636
</td>
<td>
2.741910
</td>
</tr>
<tr>
<th>
c
</th>
<td>
2.348484
</td>
<td>
3.042636
</td>
<td>
8.358324
</td>
<td>
-0.150733
</td>
</tr>
<tr>
<th>
d
</th>
<td>
-2.077213
</td>
<td>
2.741910
</td>
<td>
-0.150733
</td>
<td>
3.696565
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.T@df1</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
a
</th>
<th>
b
</th>
<th>
c
</th>
<th>
d
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
a
</th>
<td>
7.262961
</td>
<td>
-4.896682
</td>
<td>
2.348484
</td>
<td>
-2.077213
</td>
</tr>
<tr>
<th>
b
</th>
<td>
-4.896682
</td>
<td>
8.561819
</td>
<td>
3.042636
</td>
<td>
2.741910
</td>
</tr>
<tr>
<th>
c
</th>
<td>
2.348484
</td>
<td>
3.042636
</td>
<td>
8.358324
</td>
<td>
-0.150733
</td>
</tr>
<tr>
<th>
d
</th>
<td>
-2.077213
</td>
<td>
2.741910
</td>
<td>
-0.150733
</td>
<td>
3.696565
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.dropna(axis=<span class="number">1</span>,how=<span class="string">'any'</span>) <span class="comment"># drop columns</span></span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
B
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
bird
</th>
<td>
3
</td>
</tr>
<tr>
<th>
cat
</th>
<td>
2
</td>
</tr>
<tr>
<th>
dog
</th>
<td>
1
</td>
</tr>
<tr>
<th>
goat
</th>
<td>
4
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.dropna() <span class="comment"># drop rows</span></span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
A
</th>
<th>
B
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
bird
</th>
<td>
2.0
</td>
<td>
3
</td>
</tr>
<tr>
<th>
cat
</th>
<td>
3.0
</td>
<td>
2
</td>
</tr>
<tr>
<th>
dog
</th>
<td>
1.0
</td>
<td>
1
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.dropna(axis=<span class="number">1</span>,how=<span class="string">"all"</span>) <span class="comment"># drop columns with all missing data</span></span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
A
</th>
<th>
B
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
bird
</th>
<td>
2.0
</td>
<td>
3
</td>
</tr>
<tr>
<th>
cat
</th>
<td>
3.0
</td>
<td>
2
</td>
</tr>
<tr>
<th>
dog
</th>
<td>
1.0
</td>
<td>
1
</td>
</tr>
<tr>
<th>
goat
</th>
<td>
NaN
</td>
<td>
4
</td>
</tr>
</tbody>
</table>
</div>
<p>pandas supports read/write for a wide range of different file
format</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flight.info()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 336776 entries, 0 to 336775
Data columns (total 20 columns):
 #   Column          Non-Null Count   Dtype  
---  ------          --------------   -----  
 0   year            336776 non-null  int64  
 1   month           336776 non-null  int64  
 2   day             336776 non-null  int64  
 3   dep_time        328521 non-null  float64
 4   sched_dep_time  336776 non-null  int64  
 5   dep_delay       328521 non-null  float64
 6   arr_time        328063 non-null  float64
 7   sched_arr_time  336776 non-null  int64  
 8   arr_delay       327346 non-null  float64
 9   carrier         336776 non-null  object 
 10  flight          336776 non-null  int64  
 11  tailnum         334264 non-null  object 
 12  origin          336776 non-null  object 
 13  dest            336776 non-null  object 
 14  air_time        327346 non-null  float64
 15  distance        336776 non-null  int64  
 16  hour            336776 non-null  int64  
 17  minute          336776 non-null  int64  
 18  time_hour       336776 non-null  object 
 19  max_delay       327346 non-null  float64
dtypes: float64(6), int64(9), object(5)
memory usage: 51.4+ MB</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flight.head()</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
year
</th>
<th>
month
</th>
<th>
day
</th>
<th>
dep_time
</th>
<th>
sched_dep_time
</th>
<th>
dep_delay
</th>
<th>
arr_time
</th>
<th>
sched_arr_time
</th>
<th>
arr_delay
</th>
<th>
carrier
</th>
<th>
flight
</th>
<th>
tailnum
</th>
<th>
origin
</th>
<th>
dest
</th>
<th>
air_time
</th>
<th>
distance
</th>
<th>
hour
</th>
<th>
minute
</th>
<th>
time_hour
</th>
<th>
max_delay
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
2013
</td>
<td>
1
</td>
<td>
1
</td>
<td>
517.0
</td>
<td>
515
</td>
<td>
2.0
</td>
<td>
830.0
</td>
<td>
819
</td>
<td>
11.0
</td>
<td>
UA
</td>
<td>
1545
</td>
<td>
N14228
</td>
<td>
EWR
</td>
<td>
IAH
</td>
<td>
227.0
</td>
<td>
1400
</td>
<td>
5
</td>
<td>
15
</td>
<td>
2013-01-01T10:00:00Z
</td>
<td>
11.0
</td>
</tr>
<tr>
<th>
1
</th>
<td>
2013
</td>
<td>
1
</td>
<td>
1
</td>
<td>
533.0
</td>
<td>
529
</td>
<td>
4.0
</td>
<td>
850.0
</td>
<td>
830
</td>
<td>
20.0
</td>
<td>
UA
</td>
<td>
1714
</td>
<td>
N24211
</td>
<td>
LGA
</td>
<td>
IAH
</td>
<td>
227.0
</td>
<td>
1416
</td>
<td>
5
</td>
<td>
29
</td>
<td>
2013-01-01T10:00:00Z
</td>
<td>
20.0
</td>
</tr>
<tr>
<th>
2
</th>
<td>
2013
</td>
<td>
1
</td>
<td>
1
</td>
<td>
542.0
</td>
<td>
540
</td>
<td>
2.0
</td>
<td>
923.0
</td>
<td>
850
</td>
<td>
33.0
</td>
<td>
AA
</td>
<td>
1141
</td>
<td>
N619AA
</td>
<td>
JFK
</td>
<td>
MIA
</td>
<td>
160.0
</td>
<td>
1089
</td>
<td>
5
</td>
<td>
40
</td>
<td>
2013-01-01T10:00:00Z
</td>
<td>
33.0
</td>
</tr>
<tr>
<th>
3
</th>
<td>
2013
</td>
<td>
1
</td>
<td>
1
</td>
<td>
544.0
</td>
<td>
545
</td>
<td>
-1.0
</td>
<td>
1004.0
</td>
<td>
1022
</td>
<td>
-18.0
</td>
<td>
B6
</td>
<td>
725
</td>
<td>
N804JB
</td>
<td>
JFK
</td>
<td>
BQN
</td>
<td>
183.0
</td>
<td>
1576
</td>
<td>
5
</td>
<td>
45
</td>
<td>
2013-01-01T10:00:00Z
</td>
<td>
-1.0
</td>
</tr>
<tr>
<th>
4
</th>
<td>
2013
</td>
<td>
1
</td>
<td>
1
</td>
<td>
554.0
</td>
<td>
600
</td>
<td>
-6.0
</td>
<td>
812.0
</td>
<td>
837
</td>
<td>
-25.0
</td>
<td>
DL
</td>
<td>
461
</td>
<td>
N668DN
</td>
<td>
LGA
</td>
<td>
ATL
</td>
<td>
116.0
</td>
<td>
762
</td>
<td>
6
</td>
<td>
0
</td>
<td>
2013-01-01T11:00:00Z
</td>
<td>
-6.0
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flight.tail()</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
year
</th>
<th>
month
</th>
<th>
day
</th>
<th>
dep_time
</th>
<th>
sched_dep_time
</th>
<th>
dep_delay
</th>
<th>
arr_time
</th>
<th>
sched_arr_time
</th>
<th>
arr_delay
</th>
<th>
carrier
</th>
<th>
flight
</th>
<th>
tailnum
</th>
<th>
origin
</th>
<th>
dest
</th>
<th>
air_time
</th>
<th>
distance
</th>
<th>
hour
</th>
<th>
minute
</th>
<th>
time_hour
</th>
<th>
max_delay
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
336771
</th>
<td>
2013
</td>
<td>
9
</td>
<td>
30
</td>
<td>
NaN
</td>
<td>
1455
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
1634
</td>
<td>
NaN
</td>
<td>
9E
</td>
<td>
3393
</td>
<td>
NaN
</td>
<td>
JFK
</td>
<td>
DCA
</td>
<td>
NaN
</td>
<td>
213
</td>
<td>
14
</td>
<td>
55
</td>
<td>
2013-09-30T18:00:00Z
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
336772
</th>
<td>
2013
</td>
<td>
9
</td>
<td>
30
</td>
<td>
NaN
</td>
<td>
2200
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
2312
</td>
<td>
NaN
</td>
<td>
9E
</td>
<td>
3525
</td>
<td>
NaN
</td>
<td>
LGA
</td>
<td>
SYR
</td>
<td>
NaN
</td>
<td>
198
</td>
<td>
22
</td>
<td>
0
</td>
<td>
2013-10-01T02:00:00Z
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
336773
</th>
<td>
2013
</td>
<td>
9
</td>
<td>
30
</td>
<td>
NaN
</td>
<td>
1210
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
1330
</td>
<td>
NaN
</td>
<td>
MQ
</td>
<td>
3461
</td>
<td>
N535MQ
</td>
<td>
LGA
</td>
<td>
BNA
</td>
<td>
NaN
</td>
<td>
764
</td>
<td>
12
</td>
<td>
10
</td>
<td>
2013-09-30T16:00:00Z
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
336774
</th>
<td>
2013
</td>
<td>
9
</td>
<td>
30
</td>
<td>
NaN
</td>
<td>
1159
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
1344
</td>
<td>
NaN
</td>
<td>
MQ
</td>
<td>
3572
</td>
<td>
N511MQ
</td>
<td>
LGA
</td>
<td>
CLE
</td>
<td>
NaN
</td>
<td>
419
</td>
<td>
11
</td>
<td>
59
</td>
<td>
2013-09-30T15:00:00Z
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
336775
</th>
<td>
2013
</td>
<td>
9
</td>
<td>
30
</td>
<td>
NaN
</td>
<td>
840
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
1020
</td>
<td>
NaN
</td>
<td>
MQ
</td>
<td>
3531
</td>
<td>
N839MQ
</td>
<td>
LGA
</td>
<td>
RDU
</td>
<td>
NaN
</td>
<td>
431
</td>
<td>
8
</td>
<td>
40
</td>
<td>
2013-09-30T12:00:00Z
</td>
<td>
NaN
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df1 = df*<span class="number">2</span></span><br><span class="line">df2 = df+df</span><br><span class="line">(df1==df2).<span class="built_in">all</span>() <span class="comment"># 有NaN，判断相等时要小心</span></span><br></pre></td></tr></tbody></table></figure>
<pre><code>A    False
B     True
dtype: bool</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.nan==np.nan</span><br></pre></td></tr></tbody></table></figure>
<pre><code>False</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.equals(df2)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>True</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.mean(<span class="number">0</span>) <span class="comment"># mean of colums</span></span><br></pre></td></tr></tbody></table></figure>
<pre><code>A    4.0
B    5.0
dtype: float64</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.mean(<span class="number">1</span>) <span class="comment"># mean of rows</span></span><br></pre></td></tr></tbody></table></figure>
<pre><code>bird    5.0
cat     5.0
dog     2.0
goat    8.0
dtype: float64</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.mean(df1) <span class="comment"># skip na, 也可以设置skipna=False</span></span><br></pre></td></tr></tbody></table></figure>
<pre><code>A    4.0
B    5.0
dtype: float64</code></pre>
<blockquote>
<p>np.mean作用于dataframe时，自动跳过nan，但是on np.array时，返回nan</p>
</blockquote>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flight.describe()</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
year
</th>
<th>
month
</th>
<th>
day
</th>
<th>
dep_time
</th>
<th>
sched_dep_time
</th>
<th>
dep_delay
</th>
<th>
arr_time
</th>
<th>
sched_arr_time
</th>
<th>
arr_delay
</th>
<th>
flight
</th>
<th>
air_time
</th>
<th>
distance
</th>
<th>
hour
</th>
<th>
minute
</th>
<th>
max_delay
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
count
</th>
<td>
336776.0
</td>
<td>
336776.000000
</td>
<td>
336776.000000
</td>
<td>
328521.000000
</td>
<td>
336776.000000
</td>
<td>
328521.000000
</td>
<td>
328063.000000
</td>
<td>
336776.000000
</td>
<td>
327346.000000
</td>
<td>
336776.000000
</td>
<td>
327346.000000
</td>
<td>
336776.000000
</td>
<td>
336776.000000
</td>
<td>
336776.000000
</td>
<td>
327346.000000
</td>
</tr>
<tr>
<th>
mean
</th>
<td>
2013.0
</td>
<td>
6.548510
</td>
<td>
15.710787
</td>
<td>
1349.109947
</td>
<td>
1344.254840
</td>
<td>
12.639070
</td>
<td>
1502.054999
</td>
<td>
1536.380220
</td>
<td>
6.895377
</td>
<td>
1971.923620
</td>
<td>
150.686460
</td>
<td>
1039.912604
</td>
<td>
13.180247
</td>
<td>
26.230100
</td>
<td>
16.969943
</td>
</tr>
<tr>
<th>
std
</th>
<td>
0.0
</td>
<td>
3.414457
</td>
<td>
8.768607
</td>
<td>
488.281791
</td>
<td>
467.335756
</td>
<td>
40.210061
</td>
<td>
533.264132
</td>
<td>
497.457142
</td>
<td>
44.633292
</td>
<td>
1632.471938
</td>
<td>
93.688305
</td>
<td>
733.233033
</td>
<td>
4.661316
</td>
<td>
19.300846
</td>
<td>
42.376455
</td>
</tr>
<tr>
<th>
min
</th>
<td>
2013.0
</td>
<td>
1.000000
</td>
<td>
1.000000
</td>
<td>
1.000000
</td>
<td>
106.000000
</td>
<td>
-43.000000
</td>
<td>
1.000000
</td>
<td>
1.000000
</td>
<td>
-86.000000
</td>
<td>
1.000000
</td>
<td>
20.000000
</td>
<td>
17.000000
</td>
<td>
1.000000
</td>
<td>
0.000000
</td>
<td>
-33.000000
</td>
</tr>
<tr>
<th>
25%
</th>
<td>
2013.0
</td>
<td>
4.000000
</td>
<td>
8.000000
</td>
<td>
907.000000
</td>
<td>
906.000000
</td>
<td>
-5.000000
</td>
<td>
1104.000000
</td>
<td>
1124.000000
</td>
<td>
-17.000000
</td>
<td>
553.000000
</td>
<td>
82.000000
</td>
<td>
502.000000
</td>
<td>
9.000000
</td>
<td>
8.000000
</td>
<td>
-4.000000
</td>
</tr>
<tr>
<th>
50%
</th>
<td>
2013.0
</td>
<td>
7.000000
</td>
<td>
16.000000
</td>
<td>
1401.000000
</td>
<td>
1359.000000
</td>
<td>
-2.000000
</td>
<td>
1535.000000
</td>
<td>
1556.000000
</td>
<td>
-5.000000
</td>
<td>
1496.000000
</td>
<td>
129.000000
</td>
<td>
872.000000
</td>
<td>
13.000000
</td>
<td>
29.000000
</td>
<td>
1.000000
</td>
</tr>
<tr>
<th>
75%
</th>
<td>
2013.0
</td>
<td>
10.000000
</td>
<td>
23.000000
</td>
<td>
1744.000000
</td>
<td>
1729.000000
</td>
<td>
11.000000
</td>
<td>
1940.000000
</td>
<td>
1945.000000
</td>
<td>
14.000000
</td>
<td>
3465.000000
</td>
<td>
192.000000
</td>
<td>
1389.000000
</td>
<td>
17.000000
</td>
<td>
44.000000
</td>
<td>
19.000000
</td>
</tr>
<tr>
<th>
max
</th>
<td>
2013.0
</td>
<td>
12.000000
</td>
<td>
31.000000
</td>
<td>
2400.000000
</td>
<td>
2359.000000
</td>
<td>
1301.000000
</td>
<td>
2400.000000
</td>
<td>
2359.000000
</td>
<td>
1272.000000
</td>
<td>
8500.000000
</td>
<td>
695.000000
</td>
<td>
4983.000000
</td>
<td>
23.000000
</td>
<td>
59.000000
</td>
<td>
1301.000000
</td>
</tr>
</tbody>
</table>
</div>
<h2 id="pipe-method-method-chaining"><code>pipe</code> method: method
chaining</h2>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">f = <span class="keyword">lambda</span> x : x**<span class="number">2</span></span><br><span class="line">g = <span class="keyword">lambda</span> x : x+<span class="number">1</span></span><br><span class="line">h = <span class="keyword">lambda</span> x : <span class="number">2</span>*x</span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">5</span>,<span class="number">3</span>),columns=[<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>])</span><br><span class="line">df</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
A
</th>
<th>
B
</th>
<th>
C
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
-0.413218
</td>
<td>
0.348975
</td>
<td>
-1.313533
</td>
</tr>
<tr>
<th>
1
</th>
<td>
1.658054
</td>
<td>
0.495508
</td>
<td>
2.021334
</td>
</tr>
<tr>
<th>
2
</th>
<td>
-1.136187
</td>
<td>
0.002771
</td>
<td>
-1.651880
</td>
</tr>
<tr>
<th>
3
</th>
<td>
-1.125284
</td>
<td>
0.205869
</td>
<td>
-0.670324
</td>
</tr>
<tr>
<th>
4
</th>
<td>
1.085758
</td>
<td>
-0.103062
</td>
<td>
2.407278
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">h(g(f(df)))</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
A
</th>
<th>
B
</th>
<th>
C
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
2.341498
</td>
<td>
2.243567
</td>
<td>
5.450740
</td>
</tr>
<tr>
<th>
1
</th>
<td>
7.498284
</td>
<td>
2.491057
</td>
<td>
10.171579
</td>
</tr>
<tr>
<th>
2
</th>
<td>
4.581844
</td>
<td>
2.000015
</td>
<td>
7.457418
</td>
</tr>
<tr>
<th>
3
</th>
<td>
4.532527
</td>
<td>
2.084764
</td>
<td>
2.898668
</td>
</tr>
<tr>
<th>
4
</th>
<td>
4.357740
</td>
<td>
2.021243
</td>
<td>
13.589975
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.pipe(f).pipe(g).pipe(h)</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
A
</th>
<th>
B
</th>
<th>
C
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
2.341498
</td>
<td>
2.243567
</td>
<td>
5.450740
</td>
</tr>
<tr>
<th>
1
</th>
<td>
7.498284
</td>
<td>
2.491057
</td>
<td>
10.171579
</td>
</tr>
<tr>
<th>
2
</th>
<td>
4.581844
</td>
<td>
2.000015
</td>
<td>
7.457418
</td>
</tr>
<tr>
<th>
3
</th>
<td>
4.532527
</td>
<td>
2.084764
</td>
<td>
2.898668
</td>
</tr>
<tr>
<th>
4
</th>
<td>
4.357740
</td>
<td>
2.021243
</td>
<td>
13.589975
</td>
</tr>
</tbody>
</table>
</div>
<h2 id="row--and-column-wise-function-apply">row- and column-wise
function: <code>apply()</code></h2>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flight.apply()</span><br></pre></td></tr></tbody></table></figure>
<h2 id="pandas-ii">Pandas II</h2>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s = pd.Series(np.random.randn(<span class="number">8</span>))</span><br><span class="line">s.pct_change()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>0         NaN
1   -3.496694
2   -1.735719
3   -0.905374
4    2.515764
5   -1.755356
6    0.058851
7    2.335997
dtype: float64</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s1 = pd.Series(np.random.randn(<span class="number">100</span>))</span><br><span class="line">s2 = pd.Series(<span class="number">0.1</span>*s1+np.random.randn(<span class="number">100</span>))</span><br><span class="line">s1.cov(s2)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>0.2999112016156914</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s = pd.Series(np.random.randn(<span class="number">5</span>),index=<span class="built_in">list</span>(<span class="string">'abcde'</span>))</span><br><span class="line">s</span><br></pre></td></tr></tbody></table></figure>
<pre><code>a   -0.709341
b    0.346186
c    0.136598
d   -0.826597
e   -1.181088
dtype: float64</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s.rank()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>a    3.0
b    5.0
c    4.0
d    2.0
e    1.0
dtype: float64</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s[<span class="number">0</span>]=s[<span class="number">1</span>]=<span class="number">0</span></span><br><span class="line">s.rank()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>a    3.5
b    3.5
c    5.0
d    2.0
e    1.0
dtype: float64</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tsdf = pd.DataFrame(np.random.randn(<span class="number">10</span>,<span class="number">3</span>),columns=[<span class="string">'DOW'</span>,<span class="string">'NASDAQ'</span>,<span class="string">'SP500'</span>],index=pd.date_range(<span class="string">'1/1/2000'</span>,periods=<span class="number">10</span>))</span><br><span class="line">tsdf</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
DOW
</th>
<th>
NASDAQ
</th>
<th>
SP500
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
2000-01-01
</th>
<td>
0.656688
</td>
<td>
-1.531741
</td>
<td>
-0.024392
</td>
</tr>
<tr>
<th>
2000-01-02
</th>
<td>
-0.706209
</td>
<td>
0.325865
</td>
<td>
-0.329847
</td>
</tr>
<tr>
<th>
2000-01-03
</th>
<td>
-0.127025
</td>
<td>
0.806435
</td>
<td>
-0.910426
</td>
</tr>
<tr>
<th>
2000-01-04
</th>
<td>
-0.401866
</td>
<td>
0.191501
</td>
<td>
-0.204383
</td>
</tr>
<tr>
<th>
2000-01-05
</th>
<td>
-1.283493
</td>
<td>
1.175840
</td>
<td>
-1.195107
</td>
</tr>
<tr>
<th>
2000-01-06
</th>
<td>
0.467726
</td>
<td>
-0.255641
</td>
<td>
0.056299
</td>
</tr>
<tr>
<th>
2000-01-07
</th>
<td>
-0.371994
</td>
<td>
0.140242
</td>
<td>
-0.650468
</td>
</tr>
<tr>
<th>
2000-01-08
</th>
<td>
0.818794
</td>
<td>
0.461664
</td>
<td>
1.267799
</td>
</tr>
<tr>
<th>
2000-01-09
</th>
<td>
2.121635
</td>
<td>
1.405991
</td>
<td>
-0.179316
</td>
</tr>
<tr>
<th>
2000-01-10
</th>
<td>
-1.062810
</td>
<td>
0.308460
</td>
<td>
1.338484
</td>
</tr>
</tbody>
</table>
</div>
<p>apply to each column</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tsdf.agg([np.median,np.mean,np.std])</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
DOW
</th>
<th>
NASDAQ
</th>
<th>
SP500
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
median
</th>
<td>
-0.249509
</td>
<td>
0.317162
</td>
<td>
-0.191849
</td>
</tr>
<tr>
<th>
mean
</th>
<td>
0.011145
</td>
<td>
0.302862
</td>
<td>
-0.083136
</td>
</tr>
<tr>
<th>
std
</th>
<td>
1.022643
</td>
<td>
0.814786
</td>
<td>
0.829758
</td>
</tr>
</tbody>
</table>
</div>
<p>agg can take dict as functions</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tsdf.agg({<span class="string">'DOW'</span>:<span class="string">'mean'</span>,<span class="string">'NASDAQ'</span>:<span class="string">'median'</span>,<span class="string">'SP500'</span>:<span class="string">'max'</span>})</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>DOW       0.011145
NASDAQ    0.317162
SP500     1.338484
dtype: float64</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tsdf.corr(method=<span class="string">'spearman'</span>)</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
DOW
</th>
<th>
NASDAQ
</th>
<th>
SP500
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
DOW
</th>
<td>
1.000000
</td>
<td>
-0.018182
</td>
<td>
0.369697
</td>
</tr>
<tr>
<th>
NASDAQ
</th>
<td>
-0.018182
</td>
<td>
1.000000
</td>
<td>
-0.345455
</td>
</tr>
<tr>
<th>
SP500
</th>
<td>
0.369697
</td>
<td>
-0.345455
</td>
<td>
1.000000
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tsdf.corr(method=<span class="string">'pearson'</span>)</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
DOW
</th>
<th>
NASDAQ
</th>
<th>
SP500
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
DOW
</th>
<td>
1.000000
</td>
<td>
-0.012922
</td>
<td>
0.191341
</td>
</tr>
<tr>
<th>
NASDAQ
</th>
<td>
-0.012922
</td>
<td>
1.000000
</td>
<td>
-0.222936
</td>
</tr>
<tr>
<th>
SP500
</th>
<td>
0.191341
</td>
<td>
-0.222936
</td>
<td>
1.000000
</td>
</tr>
</tbody>
</table>
</div>
<p>dataframe ranks columns(default)</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tsdf.rank()</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
DOW
</th>
<th>
NASDAQ
</th>
<th>
SP500
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
2000-01-01
</th>
<td>
8.0
</td>
<td>
1.0
</td>
<td>
7.0
</td>
</tr>
<tr>
<th>
2000-01-02
</th>
<td>
3.0
</td>
<td>
6.0
</td>
<td>
4.0
</td>
</tr>
<tr>
<th>
2000-01-03
</th>
<td>
6.0
</td>
<td>
8.0
</td>
<td>
2.0
</td>
</tr>
<tr>
<th>
2000-01-04
</th>
<td>
4.0
</td>
<td>
4.0
</td>
<td>
5.0
</td>
</tr>
<tr>
<th>
2000-01-05
</th>
<td>
1.0
</td>
<td>
9.0
</td>
<td>
1.0
</td>
</tr>
<tr>
<th>
2000-01-06
</th>
<td>
7.0
</td>
<td>
2.0
</td>
<td>
8.0
</td>
</tr>
<tr>
<th>
2000-01-07
</th>
<td>
5.0
</td>
<td>
3.0
</td>
<td>
3.0
</td>
</tr>
<tr>
<th>
2000-01-08
</th>
<td>
9.0
</td>
<td>
7.0
</td>
<td>
9.0
</td>
</tr>
<tr>
<th>
2000-01-09
</th>
<td>
10.0
</td>
<td>
10.0
</td>
<td>
6.0
</td>
</tr>
<tr>
<th>
2000-01-10
</th>
<td>
2.0
</td>
<td>
5.0
</td>
<td>
10.0
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tsdf.rank(<span class="number">1</span>)</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
DOW
</th>
<th>
NASDAQ
</th>
<th>
SP500
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
2000-01-01
</th>
<td>
3.0
</td>
<td>
1.0
</td>
<td>
2.0
</td>
</tr>
<tr>
<th>
2000-01-02
</th>
<td>
1.0
</td>
<td>
3.0
</td>
<td>
2.0
</td>
</tr>
<tr>
<th>
2000-01-03
</th>
<td>
2.0
</td>
<td>
3.0
</td>
<td>
1.0
</td>
</tr>
<tr>
<th>
2000-01-04
</th>
<td>
1.0
</td>
<td>
3.0
</td>
<td>
2.0
</td>
</tr>
<tr>
<th>
2000-01-05
</th>
<td>
1.0
</td>
<td>
3.0
</td>
<td>
2.0
</td>
</tr>
<tr>
<th>
2000-01-06
</th>
<td>
3.0
</td>
<td>
1.0
</td>
<td>
2.0
</td>
</tr>
<tr>
<th>
2000-01-07
</th>
<td>
2.0
</td>
<td>
3.0
</td>
<td>
1.0
</td>
</tr>
<tr>
<th>
2000-01-08
</th>
<td>
2.0
</td>
<td>
1.0
</td>
<td>
3.0
</td>
</tr>
<tr>
<th>
2000-01-09
</th>
<td>
3.0
</td>
<td>
2.0
</td>
<td>
1.0
</td>
</tr>
<tr>
<th>
2000-01-10
</th>
<td>
1.0
</td>
<td>
2.0
</td>
<td>
3.0
</td>
</tr>
</tbody>
</table>
</div>
<p>iterating over Series get an iterator on values</p>
<p>iterating over dataframe get an iterator over column names</p>
<p><code>df.iteritems</code><br>
<code>df.iterrows</code></p>
<h2 id="pandasgroup-by">pandas,Group By</h2>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame({<span class="string">'A'</span>:[<span class="string">'plant'</span>,<span class="string">'animal'</span>,<span class="string">'plant'</span>,<span class="string">'plant'</span>],<span class="string">'B'</span>:[<span class="string">'apple'</span>,<span class="string">'goat'</span>,<span class="string">'kiwi'</span>,<span class="string">'grape'</span>],<span class="string">'C'</span>:np.random.randn(<span class="number">4</span>),<span class="string">'D'</span>:np.random.randn(<span class="number">4</span>)})</span><br><span class="line">df</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
A
</th>
<th>
B
</th>
<th>
C
</th>
<th>
D
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
plant
</td>
<td>
apple
</td>
<td>
2.392546
</td>
<td>
-0.554108
</td>
</tr>
<tr>
<th>
1
</th>
<td>
animal
</td>
<td>
goat
</td>
<td>
-1.292467
</td>
<td>
0.800007
</td>
</tr>
<tr>
<th>
2
</th>
<td>
plant
</td>
<td>
kiwi
</td>
<td>
0.718886
</td>
<td>
0.600089
</td>
</tr>
<tr>
<th>
3
</th>
<td>
plant
</td>
<td>
grape
</td>
<td>
-0.665115
</td>
<td>
-1.205696
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">'A'</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x00000155D469CD00&gt;</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">'A'</span>).groups</span><br></pre></td></tr></tbody></table></figure>
<pre><code>{'animal': [1], 'plant': [0, 2, 3]}</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">'A'</span>).mean()</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
C
</th>
<th>
D
</th>
</tr>
<tr>
<th>
A
</th>
<th>
</th>
<th>
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
animal
</th>
<td>
-1.292467
</td>
<td>
0.800007
</td>
</tr>
<tr>
<th>
plant
</th>
<td>
0.815439
</td>
<td>
-0.386571
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">index = pd.date_range(<span class="string">'10/1/1999'</span>,periods=<span class="number">1100</span>)</span><br><span class="line">ts = pd.Series(np.random.normal(<span class="number">0.5</span>,<span class="number">2</span>,<span class="number">1100</span>),index)</span><br><span class="line">ts.head()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>1999-10-01    1.318674
1999-10-02    2.784437
1999-10-03    4.774021
1999-10-04    0.017314
1999-10-05    2.678237
Freq: D, dtype: float64</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="keyword">lambda</span> d: d.year</span><br><span class="line">zscore = <span class="keyword">lambda</span> x: (x-x.mean())/x.std()</span><br><span class="line">transformed = ts.groupby(key).transform(zscore)</span><br><span class="line">transformed.head()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>1999-10-01    0.409280
1999-10-02    1.168705
1999-10-03    2.199526
1999-10-04   -0.264966
1999-10-05    1.113682
Freq: D, dtype: float64</code></pre>
<p>filter return ungrouped resulted</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sf = pd.Series([<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>])</span><br><span class="line">sf.groupby(sf).<span class="built_in">filter</span>(<span class="keyword">lambda</span> x: x.<span class="built_in">sum</span>()&gt;<span class="number">2</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>2    2
3    2
4    3
5    3
dtype: int64</code></pre>
<p><code>df.groupby().agg()</code><br>
<code>df.groupby().transform()</code></p>
<p><code>df.concat</code><br>
<code>df.pivot</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">np.random.seed(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">df4 = pd.DataFrame({</span><br><span class="line">    <span class="string">"stock"</span>:[<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'A'</span>, <span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'A'</span>,<span class="string">'C'</span>,<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'D'</span>,<span class="string">'D'</span>,<span class="string">'D'</span>,<span class="string">'D'</span>,<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'D'</span>],</span><br><span class="line">    <span class="string">"date"</span>:[<span class="string">'20210104'</span>,<span class="string">'20210104'</span>,<span class="string">'20210104'</span>,<span class="string">'20210102'</span>,<span class="string">'20210102'</span>,<span class="string">'20210102'</span>,</span><br><span class="line">            <span class="string">'20210103'</span>, <span class="string">'20210103'</span>, <span class="string">'20210101'</span>,<span class="string">'20210101'</span>,<span class="string">'20210101'</span>,</span><br><span class="line">            <span class="string">'20210105'</span>,<span class="string">'20210105'</span>,<span class="string">'20210105'</span>,<span class="string">'20210102'</span>,<span class="string">'20210103'</span>,<span class="string">'20210104'</span>,<span class="string">'20210105'</span>, </span><br><span class="line">            <span class="string">'20210106'</span>, <span class="string">'20210106'</span>, <span class="string">'20210106'</span>,<span class="string">'20210106'</span>],</span><br><span class="line">    <span class="string">"daily_ret"</span>:np.random.normal(<span class="number">0</span>,<span class="number">0.05</span>,<span class="number">22</span>)})</span><br><span class="line">df4_stacked = df4.pivot(index=<span class="string">'date'</span>,columns=<span class="string">'stock'</span>,values=<span class="string">'daily_ret'</span>)</span><br><span class="line">df4_stacked</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
stock
</th>
<th>
A
</th>
<th>
B
</th>
<th>
C
</th>
<th>
D
</th>
</tr>
<tr>
<th>
date
</th>
<th>
</th>
<th>
</th>
<th>
</th>
<th>
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
20210101
</th>
<td>
-0.005161
</td>
<td>
0.020530
</td>
<td>
0.007202
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
20210102
</th>
<td>
0.112045
</td>
<td>
0.093378
</td>
<td>
-0.048864
</td>
<td>
0.022193
</td>
</tr>
<tr>
<th>
20210103
</th>
<td>
0.047504
</td>
<td>
NaN
</td>
<td>
-0.007568
</td>
<td>
0.016684
</td>
</tr>
<tr>
<th>
20210104
</th>
<td>
0.088203
</td>
<td>
0.020008
</td>
<td>
0.048937
</td>
<td>
0.074704
</td>
</tr>
<tr>
<th>
20210105
</th>
<td>
0.072714
</td>
<td>
0.038052
</td>
<td>
0.006084
</td>
<td>
-0.010258
</td>
</tr>
<tr>
<th>
20210106
</th>
<td>
0.015653
</td>
<td>
-0.042705
</td>
<td>
-0.127649
</td>
<td>
0.032681
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s = df4_stacked.stack()</span><br><span class="line">s</span><br></pre></td></tr></tbody></table></figure>
<pre><code>date      stock
20210101  A       -0.005161
          B        0.020530
          C        0.007202
20210102  A        0.112045
          B        0.093378
          C       -0.048864
          D        0.022193
20210103  A        0.047504
          C       -0.007568
          D        0.016684
20210104  A        0.088203
          B        0.020008
          C        0.048937
          D        0.074704
20210105  A        0.072714
          B        0.038052
          C        0.006084
          D       -0.010258
20210106  A        0.015653
          B       -0.042705
          C       -0.127649
          D        0.032681
dtype: float64</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s[<span class="string">'20210104'</span>,<span class="string">'A'</span>]</span><br><span class="line">s[<span class="string">'20210104'</span>][<span class="string">'A'</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>0.0882026172983832</code></pre>
<h1 id="matplotlib">matplotlib</h1>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">%matplotlib inline</span><br><span class="line">x = np.arange(<span class="number">10</span>)</span><br><span class="line">_ = plt.plot(x**<span class="number">2</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>​<br>
<img src="C:/Users/junxu/OneDrive%20-%20Umich/Courses/Stats%20507/CourseNote2_files/CourseNote2_219_0.png" alt="png"> ​</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line">mpl.style.available</span><br></pre></td></tr></tbody></table></figure>
<pre><code>['Solarize_Light2',
 '_classic_test_patch',
 'bmh',
 'classic',
 'dark_background',
 'fast',
 'fivethirtyeight',
 'ggplot',
 'grayscale',
 'seaborn',
 'seaborn-bright',
 'seaborn-colorblind',
 'seaborn-dark',
 'seaborn-dark-palette',
 'seaborn-darkgrid',
 'seaborn-deep',
 'seaborn-muted',
 'seaborn-notebook',
 'seaborn-paper',
 'seaborn-pastel',
 'seaborn-poster',
 'seaborn-talk',
 'seaborn-ticks',
 'seaborn-white',
 'seaborn-whitegrid',
 'tableau-colorblind10']</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mpl.style.use(<span class="string">'ggplot'</span>)</span><br><span class="line">mpl.style.use(<span class="string">'seaborn-white'</span>)</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br><span class="line">x = np.arange(<span class="number">10</span>)</span><br><span class="line">_ = plt.plot(x**<span class="number">2</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>​<br>
<img src="C:/Users/junxu/OneDrive%20-%20Umich/Courses/Stats%20507/CourseNote2_files/CourseNote2_222_0.png" alt="png"> ​</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">t = np.arange(<span class="number">10</span>)</span><br><span class="line">s = np.random.normal(<span class="number">1</span>,<span class="number">1</span>,<span class="number">10</span>)</span><br><span class="line">_ = plt.bar(t,s,align=<span class="string">'center'</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>​<br>
<img src="C:/Users/junxu/OneDrive%20-%20Umich/Courses/Stats%20507/CourseNote2_files/CourseNote2_223_0.png" alt="png"> ​</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fig,axs = plt.subplots(nrows=<span class="number">3</span>,ncols=<span class="number">3</span>)</span><br><span class="line">x = np.arange(<span class="number">0</span>,<span class="number">100</span>)</span><br><span class="line">axs[<span class="number">0</span>][<span class="number">0</span>].plot(x,x**<span class="number">2</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>[&lt;matplotlib.lines.Line2D at 0x155d7666eb0&gt;]</code></pre>
<p>​<br>
<img src="C:/Users/junxu/OneDrive%20-%20Umich/Courses/Stats%20507/CourseNote2_files/CourseNote2_224_1.png" alt="png"> ​</p>
<h1 id="regular-expressions-and-text-encoding">Regular Expressions and
Text Encoding</h1>
<p>Unicode ASCII sebset of UTF-8</p>
<ul>
<li><code>re.match()</code> at start of string</li>
<li><code>re.search()</code> any part of string</li>
<li><code>re.findall()</code> find all matches of parttern in the
string</li>
<li>https://rex101.com</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">re.<span class="keyword">match</span>(<span class="string">'cat'</span>,<span class="string">'cats and dogs'</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>&lt;re.Match object; span=(0, 3), match='cat'&gt;</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">regex = <span class="string">'cat'</span></span><br><span class="line">re.<span class="keyword">match</span>(regex,<span class="string">'fat on mat'</span>) <span class="keyword">is</span> <span class="literal">None</span></span><br></pre></td></tr></tbody></table></figure>
<pre><code>True</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> re.<span class="keyword">match</span>(regex,<span class="string">'fat on mat'</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'matches'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'Not'</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>Not</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.search(<span class="string">'cat'</span>,<span class="string">'rains cats and dogs'</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>&lt;re.Match object; span=(6, 9), match='cat'&gt;</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> re.search(<span class="string">'cat'</span>,<span class="string">'rains cats and dogs'</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'matches'</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>matches</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.findall(<span class="string">'cat'</span>,<span class="string">'rains cats and cat'</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>['cat', 'cat']</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.<span class="keyword">match</span>(<span class="string">'\\\\\$'</span>,<span class="string">'$'</span>)</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.<span class="keyword">match</span>(<span class="string">'\\\\\$'</span>,<span class="string">'\$'</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>&lt;re.Match object; span=(0, 2), match='\\$'&gt;</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.<span class="keyword">match</span>(<span class="string">'\$'</span>,<span class="string">'$'</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>&lt;re.Match object; span=(0, 1), match='$'&gt;</code></pre>
<ul>
<li>raw text
<ul>
<li>is new line</li>
<li>r"" == "\n", raw text</li>
</ul></li>
<li>推荐在用字符串的时候都加上r</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">r"\n1.00"</span>,<span class="string">"\n1.00"</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>\n1.00 
1.00</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.<span class="keyword">match</span>(<span class="string">'$'</span>,<span class="string">'$'</span>)</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.<span class="keyword">match</span>(<span class="string">'\$'</span>,<span class="string">'$'</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>&lt;re.Match object; span=(0, 1), match='$'&gt;</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.<span class="keyword">match</span>(<span class="string">r'\$'</span>,<span class="string">'$'</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>&lt;re.Match object; span=(0, 1), match='$'&gt;</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.findall(<span class="string">"[aeiou]"</span>,<span class="string">"cats and dog"</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>['a', 'a', 'o']</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.findall(<span class="string">"[a-z ]"</span>,<span class="string">"cats and Dog"</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>['c', 'a', 't', 's', ' ', 'a', 'n', 'd', ' ', 'o', 'g']</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.findall(<span class="string">"[a-z]"</span>,<span class="string">"cats and Dog"</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>['c', 'a', 't', 's', 'a', 'n', 'd', 'o', 'g']</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.findall(<span class="string">"[A-Z]"</span>,<span class="string">"cats and Dog"</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>['D']</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.findall(<span class="string">"[a-zA-Z]"</span>,<span class="string">"cats and Dog"</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>['c', 'a', 't', 's', 'a', 'n', 'd', 'D', 'o', 'g']</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.findall(<span class="string">"[^a-zA-Z]"</span>,<span class="string">"cats and Dog"</span>) <span class="comment"># not in the list</span></span><br></pre></td></tr></tbody></table></figure>
<pre><code>[' ', ' ']</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.findall(<span class="string">"[a\-z]"</span>,<span class="string">"i am a z-ip"</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>['a', 'a', 'z', '-']</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.findall(<span class="string">"[(+*)^]"</span>,<span class="string">"1+1+2^1=3*(1)"</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>['+', '+', '^', '*', '(', ')']</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.findall(<span class="string">"[^(+*)^]"</span>,<span class="string">"1+1+2^1=3*(1)"</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>['1', '1', '2', '1', '=', '3', '1']</code></pre>
<ul>
<li>: space, tab, new line, = [ ]</li>
<li>r"" = r"[a-zA-Z_]"</li>
<li> digits = r"[0-9]"</li>
<li>"^": not in the [], start of a line</li>
<li>new line 开头有个invisible ^, end line have invisible $</li>
<li>"$": end of a line</li>
<li>".": including everything</li>
<li>只想匹配句号的话用："."</li>
<li>"o..r" match "o任意两个字母r"</li>
<li> word boundary: a 以a结尾的单词</li>
<li>如果想neglect上述，只需要大写，例如：, neglect all the words</li>
<li>+: "e+" match any number of e's</li>
<li><em>: "e</em>"</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.findall(<span class="string">"oe+"</span>,<span class="string">"oeuvree"</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>['oe']</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.findall(<span class="string">"[oe]+"</span>,<span class="string">"oeuvree"</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>['oe', 'ee']</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.findall(<span class="string">"[whe]*"</span>,<span class="string">"while wheeee weheee"</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>['wh', '', '', 'e', '', 'wheeee', '', 'weheee', '']</code></pre>
<p>‘*’ : zero or more of the previous item</p>
<p>‘+’ : one or more of the previous item</p>
<p>‘?’ : zero or one of the previous item</p>
<p>‘{4}’ : exactly four of the previous item</p>
<p>‘{3,}’ : three or more of previous item</p>
<p>‘{2,5}’ : between two and five (inclusive) of previous item</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.findall(<span class="string">"whe*"</span>,<span class="string">"while wheeee weheee heee weee"</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>['wh', 'wheeee']</code></pre>
<p>‘|’ (“pipe”) is a special character that allows one to specify “or”
clauses</p>
<p>Example: I want to match the word “cat” or the word “dog”</p>
<p>Solution: ‘(cat|dog)’ 记得加括号！！！</p>
<p>Note: parentheses are not strictly necessary here, but parentheses
tend to make for easier reading and avoid possible ambiguity. It’s a
good habit to just use them always.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.findall(<span class="string">r"a|aa|aaa"</span>,<span class="string">"aaaa"</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>['a', 'a', 'a', 'a']</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.findall(<span class="string">r"a+"</span>,<span class="string">"aaaa"</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>['aaaa']</code></pre>
<p>'?' modifies operators like '+' and '*' not be greedy,get lazy
matching</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.findall(<span class="string">r"a+?"</span>,<span class="string">"aaaa"</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>['a', 'a', 'a', 'a']</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.findall(<span class="string">"\w+@\w+\.\w+"</span>,<span class="string">"your email is kobe@icloud.com, his email is jacob@umich.edu"</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>['kobe@icloud.com', 'jacob@umich.edu']</code></pre>
<p>capture group ():</p>
<ul>
<li>(+@+.+)</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">regex = <span class="string">r'(\w+@\w+\.\w+)'</span></span><br><span class="line">s = <span class="string">"your email is kobe@icloud.com kobe@icloud.com his email is jacob@umich.edu"</span></span><br><span class="line">m=re.findall(regex,s)</span><br><span class="line">m</span><br></pre></td></tr></tbody></table></figure>
<pre><code>['kobe@icloud.com', 'kobe@icloud.com', 'jacob@umich.edu']</code></pre>
<ul>
<li>backreferences
<ul>
<li>in paranthesis() occur once again
<ul>
<li>([a-zA-Z]+).*\1 首尾以相同字段开始和结束，中间任意</li>
</ul></li>
</ul></li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">regex = <span class="string">r'(\w+)\1'</span></span><br><span class="line">s = <span class="string">"freefree"</span></span><br><span class="line">m = re.search(regex,s)</span><br><span class="line">m.group(<span class="number">1</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>'free'</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">regex = <span class="string">r'\w+'</span></span><br><span class="line">s = <span class="string">"nonrepeat"</span></span><br><span class="line">m = re.search(regex,s)</span><br><span class="line">m.group(<span class="number">0</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>'nonrepeat'</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<h1 id="sql">SQL</h1>
<ul>
<li>每列一个type</li>
<li>key: uniquely identify a record</li>
<li>sqliteonline.com</li>
<li>features:
<ul>
<li>atomicity</li>
<li>consistency</li>
<li>isolation</li>
<li>durability</li>
</ul></li>
<li>https://www.w3schools.com/sql/</li>
<li>select
<ul>
<li>SELECT * FROM countries</li>
<li>SELECT id, name FROM countries</li>
<li>SELECT * FROM countries WHERE [filter]</li>
<li>&lt;&gt; !=</li>
<li>= ==</li>
<li>SELECT * FROM countries WHERE [] BETWEEN 86 AND 90</li>
<li>SELECT * FROM countries WHERE [filter] IS NULL
<ul>
<li>Note: 空格不会match NULL</li>
</ul></li>
</ul></li>
<li>SORT
<ul>
<li>ORDER BY
<ul>
<li>SELECT [columns] FROM [table] ORDER BY [column] [ASC|DESC]</li>
<li>SELECT [columns] FROM countries ORDER BY phonecode ASC, name
DESC</li>
<li>等价于 SELECT [columns] FROM countries ORDER BY phonecode, name
DESC</li>
<li>默认ASC</li>
</ul></li>
</ul></li>
<li>DISTINCT
<ul>
<li>SELECT DISTINCT [columns] FROM [table]</li>
</ul></li>
<li>WHERE
<ul>
<li>支持set
<ul>
<li>SELECT id from t_student WHERE major IN
("Mathematics","statistics")</li>
<li>SELECT id from t_student WHERE major NOT IN
("Mathematics","statistics")</li>
</ul></li>
<li>支持regex-like matching
<ul>
<li>SELCET id from t_student WHERE first_name LIKE "M%"</li>
<li>%: match any number of letters</li>
<li>_: match one number of letters</li>
</ul></li>
</ul></li>
<li>GROUP BY
<ul>
<li>SELECT customer_id, SUM(dollar_amount) FROM t_transactions GROUP BY
customer_id</li>
<li>COUNT, AVG, MIN, MAX: aggregate function</li>
<li>SECLECT phonecode, COUNT() FROM countries GROUP BY phonecode</li>
<li>HAVING: filer results after GROUP BY using the HAVING keyword
<ul>
<li>SELECT customer_id, SUM(dollar_amount) AS total_dolar FROM
t_transactions GROUP BY customer_id HAVING total_dolar &gt;50</li>
</ul></li>
</ul></li>
<li>JOIN: merging tables
<ul>
<li>INNER JOIN
<ul>
<li>SELECT id, name, color FROM t_student INNER JOIN t_personal ON
t_students.id=t_personal.id</li>
</ul></li>
<li>LEFT JOIN</li>
<li>RIGHT JOIN</li>
<li>FULL JOIN</li>
</ul></li>
<li>INSERT INTO
<ul>
<li>INSERT INTO table_name [col1, col2, col3, …] VALUES value1, value2,
value3, …</li>
</ul></li>
<li>UPDATE
<ul>
<li>UPDATE table_name SET col1=value1,col2=value2, WHERE condition</li>
<li>Caution: if WHERE is left empty, you'll delete/modify the whole
tanle!</li>
</ul></li>
<li>DELETE
<ul>
<li>DELETE FROM table_name WHERE condition</li>
</ul></li>
<li>CREATE TABLE
<ul>
<li>CREATE TABLE table_name [col1 datatype, col2 datatype, …]</li>
</ul></li>
<li>DROP TABLE
<ul>
<li>DROP TABLE table_name;</li>
</ul></li>
<li>SELECT * FROM sqlite_master</li>
<li>SELECT * FROM sqlite_master WHERE type="table"</li>
</ul>
<p>课件里的python例子</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line">con = sqlite3.connect(<span class="string">'ps8/flights.sqlite'</span>)</span><br><span class="line">cur = con.cursor()</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">con</span><br></pre></td></tr></tbody></table></figure>
<pre><code>&lt;sqlite3.Connection at 0x2615592b040&gt;</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">res = cur.execute(<span class="string">"select * from flights limit 10"</span>) <span class="comment"># head 10 of table</span></span><br><span class="line">res</span><br></pre></td></tr></tbody></table></figure>
<pre><code>&lt;sqlite3.Cursor at 0x2615594d3c0&gt;</code></pre>
<p>(Actually, <code>res</code> is just the original cursor itself):</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res <span class="keyword">is</span> cur</span><br></pre></td></tr></tbody></table></figure>
<pre><code>True</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> res:</span><br><span class="line">    <span class="built_in">print</span>(row[<span class="number">0</span>])</span><br></pre></td></tr></tbody></table></figure>
<pre><code>2013
2013
2013
2013
2013
2013
2013
2013
2013
2013</code></pre>
<h2 id="fetching-results">Fetching results</h2>
<p>To retrieve results, use the <code>cur.fetchone()</code> or
<code>cur.fetchall()</code> methods:</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">res = cur.execute(<span class="string">"select * from flights limit 10"</span>) <span class="comment"># head 10 of table</span></span><br><span class="line"></span><br><span class="line">cur.fetchone()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>(2013,
 1,
 1,
 517,
 515,
 2.0,
 830,
 819,
 11.0,
 'UA',
 1545,
 'N14228',
 'EWR',
 'IAH',
 227.0,
 1400.0,
 5.0,
 15.0,
 1357034400.0)</code></pre>
<p>This returns a tuple containing one entry for each column in our
<code>SELECT</code> statement.</p>
<p>If you want all the rows, use <code>cur.fetchall()</code>:</p>
<p>It is an iterator</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">len</span>(res.fetchall())</span><br></pre></td></tr></tbody></table></figure>
<pre><code>9</code></pre>
<p>Notice that <code>.fetchall()</code> works like an iterator--we
<code>SELECT</code>ed 10 rows, fetched one of them using
<code>.fetchone()</code>, and then fetched the remaining 9 using
<code>.fetchall()</code>. If we run this again we'll get zero rows back
because we already fetched everything:</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">len</span>(res.fetchall())</span><br></pre></td></tr></tbody></table></figure>
<pre><code>0</code></pre>
<h2 id="parameterized-queries">Parameterized queries</h2>
<p>Sometimes our queries must depend on user input. Consider the
following query which returns all the flights that happened in a certain
month:</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">num_flights_in_month</span>(<span class="params">month</span>):</span><br><span class="line">    query = <span class="string">"""SELECT COUNT() FROM flights WHERE month = %d"""</span> % month</span><br><span class="line">    <span class="keyword">return</span> cur.execute(query).fetchone()[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">num_flights_in_month(<span class="number">1</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>27004</code></pre>
<p>For queries that depend on a parameter, we can use the special
placeholder <code>?</code> to have the database do parameter
substitution for us:</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">num_flights_in_month</span>(<span class="params">m</span>):</span><br><span class="line">    query = <span class="string">"""SELECT COUNT() FROM flights WHERE month = ?"""</span></span><br><span class="line">    <span class="keyword">return</span> cur.execute(query, [m]).fetchone()[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">num_flights_in_month(<span class="number">1</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>27004</code></pre>
<p>Using multiple placeholders is possible:</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">num_flights_on_day</span>(<span class="params">m, d</span>):</span><br><span class="line">    query = <span class="string">"""SELECT COUNT() FROM flights WHERE month = ? AND day = ?"""</span></span><br><span class="line">    <span class="keyword">return</span> cur.execute(query, [m, d]).fetchone()[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">num_flights_on_day(<span class="number">12</span>, <span class="number">25</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>719</code></pre>
<p>Notice that, even if there is just one parameter, you have to pass in
all the parameters as a <code>list</code>.</p>
<h2 id="why-use-placeholders">Why use placeholders</h2>
<p>Consider the following table:</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">scon = sqlite3.connect(<span class="string">":memory:"</span>) </span><br><span class="line">scon.execute(<span class="string">'CREATE TABLE users (id INTEGER PRIMARY KEY AUTOINCREMENT, username TEXT, age INT, password TEXT)'</span>)</span><br><span class="line">scon.execute(<span class="string">"""INSERT INTO users(username, age, password) VALUES </span></span><br><span class="line"><span class="string">('Jonathan', 40, 'beeri$g00d'),</span></span><br><span class="line"><span class="string">('Sarah', 41, 'wat3rp0l0'),</span></span><br><span class="line"><span class="string">('Julian', 2, 'il0vecr0ut0n3')</span></span><br><span class="line"><span class="string">"""</span>)</span><br><span class="line">scon.commit()</span><br></pre></td></tr></tbody></table></figure>
<p>Here's our table:</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">pd.read_sql_query(<span class="string">"SELECT * from users"</span>, scon)</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
id
</th>
<th>
username
</th>
<th>
age
</th>
<th>
password
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
1
</td>
<td>
Jonathan
</td>
<td>
40
</td>
<td>
beeri$g00d
</td>
</tr>
<tr>
<th>
1
</th>
<td>
2
</td>
<td>
Sarah
</td>
<td>
41
</td>
<td>
wat3rp0l0
</td>
</tr>
<tr>
<th>
2
</th>
<td>
3
</td>
<td>
Julian
</td>
<td>
2
</td>
<td>
il0vecr0ut0n3
</td>
</tr>
</tbody>
</table>
</div>
<p>Now let's say we have a function which takes a user-supplied
parameter, their username, and returns their user information:</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">user_info</span>(<span class="params">username</span>):</span><br><span class="line">    q = <span class="string">"SELECT * FROM users WHERE username = '%s'"</span> % username</span><br><span class="line">    <span class="built_in">print</span>(q)</span><br><span class="line">    <span class="keyword">return</span> pd.read_sql_query(q, scon)</span><br><span class="line"></span><br><span class="line">user_info(<span class="string">'Jonathan'</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>SELECT * FROM users WHERE username = 'Jonathan'</code></pre>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
id
</th>
<th>
username
</th>
<th>
age
</th>
<th>
password
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
1
</td>
<td>
Jonathan
</td>
<td>
40
</td>
<td>
beeri$g00d
</td>
</tr>
</tbody>
</table>
</div>
<p>This works great assuming that what got passed in is actually a
username, but a malicious user could do the following:</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user_info(<span class="string">"""abc' or 'a'='a"""</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>SELECT * FROM users WHERE username = 'abc' or 'a'='a'</code></pre>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
id
</th>
<th>
username
</th>
<th>
age
</th>
<th>
password
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
1
</td>
<td>
Jonathan
</td>
<td>
40
</td>
<td>
beeri$g00d
</td>
</tr>
<tr>
<th>
1
</th>
<td>
2
</td>
<td>
Sarah
</td>
<td>
41
</td>
<td>
wat3rp0l0
</td>
</tr>
<tr>
<th>
2
</th>
<td>
3
</td>
<td>
Julian
</td>
<td>
2
</td>
<td>
il0vecr0ut0n3
</td>
</tr>
</tbody>
</table>
</div>
<p>This is known as an <strong>injection attack</strong>. For this
reason, we do not passed user input directly into a query string.
Instead we use placeholders, and rely on the SQL engine itself to
perform the substitution:</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">safe_user_info</span>(<span class="params">username</span>):</span><br><span class="line">    q = <span class="string">"SELECT * FROM users WHERE username = ?"</span></span><br><span class="line">    <span class="built_in">print</span>(q)</span><br><span class="line">    <span class="keyword">return</span> pd.read_sql_query(q, scon, params=[username])</span><br><span class="line"></span><br><span class="line">safe_user_info(<span class="string">'Jonathan'</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>SELECT * FROM users WHERE username = ?</code></pre>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
id
</th>
<th>
username
</th>
<th>
age
</th>
<th>
password
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
1
</td>
<td>
Jonathan
</td>
<td>
40
</td>
<td>
beeri$g00d
</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">safe_user_info(<span class="string">"""abc' or 'a'='a"""</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>SELECT * FROM users WHERE username = ?</code></pre>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
id
</th>
<th>
username
</th>
<th>
age
</th>
<th>
password
</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
<h1 id="ten-questions-about-flights">Ten questions about
<code>flights</code></h1>
<p>Now we will use SQL queries to various questions about the
<code>flights</code> dataset.</p>
<h2 id="which-airport-is-the-busiest">Which airport is the busiest?</h2>
<p>We need to aggregate <code>flights</code> by the <code>origin</code>
column, and they count the number of rows in each group.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cur.execute(<span class="string">"SELECT origin, COUNT() FROM flights GROUP BY origin"</span>).fetchall()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>[('EWR', 120835), ('JFK', 111279), ('LGA', 104662)]</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cur.execute(<span class="string">"SELECT origin, COUNT() FROM flights GROUP BY origin"</span>).description</span><br></pre></td></tr></tbody></table></figure>
<pre><code>(('origin', None, None, None, None, None, None),
 ('COUNT()', None, None, None, None, None, None))</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.read_sql_query(<span class="string">"SELECT origin, COUNT() FROM flights GROUP BY origin"</span>,con)</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
origin
</th>
<th>
COUNT()
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
EWR
</td>
<td>
120835
</td>
</tr>
<tr>
<th>
1
</th>
<td>
JFK
</td>
<td>
111279
</td>
</tr>
<tr>
<th>
2
</th>
<td>
LGA
</td>
<td>
104662
</td>
</tr>
</tbody>
</table>
</div>
<h2 id="which-month-was-coldest">Which month was coldest?</h2>
<p>We need to aggregate <code>weather</code> by <code>month</code>, and
the compute some measure of coldness.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cur.execute(<span class="string">"SELECT month, AVG(temp) FROM weather GROUP BY month"</span>).fetchall()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>[(1, 35.63566037735852),
 (2, 34.27059701492533),
 (3, 39.880071845532164),
 (4, 51.745641500694774),
 (5, 61.79500000000004),
 (6, 72.18399999999997),
 (7, 80.06622082585272),
 (8, 74.4684657039714),
 (9, 67.3712922649374),
 (10, 60.07113019891505),
 (11, 44.9904343764596),
 (12, 38.44180037313427)]</code></pre>
<h2 id="what-is-the-most-popular-carrier-at-each-of-the-three-nyc-airports">What
is the most popular carrier at each of the three NYC airports?</h2>
<p>This one is a bit trickier. We start by counting the number of
flights for each combination of <code>carrier</code> and
<code>origin</code>:</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cur.execute(<span class="string">"SELECT COUNT(), carrier, origin FROM flights GROUP BY carrier, origin"</span>).fetchall()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>[(1268, '9E', 'EWR'),
 (14651, '9E', 'JFK'),
 (2541, '9E', 'LGA'),
 (3487, 'AA', 'EWR'),
 (13783, 'AA', 'JFK'),
 (15459, 'AA', 'LGA'),
 (714, 'AS', 'EWR'),
 (6557, 'B6', 'EWR'),
 (42076, 'B6', 'JFK'),
 (6002, 'B6', 'LGA'),
 (4342, 'DL', 'EWR'),
 (20701, 'DL', 'JFK'),
 (23067, 'DL', 'LGA'),
 (43939, 'EV', 'EWR'),
 (1408, 'EV', 'JFK'),
 (8826, 'EV', 'LGA'),
 (685, 'F9', 'LGA'),
 (3260, 'FL', 'LGA'),
 (342, 'HA', 'JFK'),
 (2276, 'MQ', 'EWR'),
 (7193, 'MQ', 'JFK'),
 (16928, 'MQ', 'LGA'),
 (6, 'OO', 'EWR'),
 (26, 'OO', 'LGA'),
 (46087, 'UA', 'EWR'),
 (4534, 'UA', 'JFK'),
 (8044, 'UA', 'LGA'),
 (4405, 'US', 'EWR'),
 (2995, 'US', 'JFK'),
 (13136, 'US', 'LGA'),
 (1566, 'VX', 'EWR'),
 (3596, 'VX', 'JFK'),
 (6188, 'WN', 'EWR'),
 (6087, 'WN', 'LGA'),
 (601, 'YV', 'LGA')]</code></pre>
<p>Next, we need to rank the carriers within origin by their counts.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cur.execute(</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    SELECT RANK() OVER (</span></span><br><span class="line"><span class="string">        PARTITION BY origin</span></span><br><span class="line"><span class="string">        ORDER BY n</span></span><br><span class="line"><span class="string">    ) AS r, carrier, origin, n FROM</span></span><br><span class="line"><span class="string">    (SELECT COUNT() as n, carrier, origin FROM flights GROUP BY carrier, origin)</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">).fetchall()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>[(1, 'OO', 'EWR', 6),
 (2, 'AS', 'EWR', 714),
 (3, '9E', 'EWR', 1268),
 (4, 'VX', 'EWR', 1566),
 (5, 'MQ', 'EWR', 2276),
 (6, 'AA', 'EWR', 3487),
 (7, 'DL', 'EWR', 4342),
 (8, 'US', 'EWR', 4405),
 (9, 'WN', 'EWR', 6188),
 (10, 'B6', 'EWR', 6557),
 (11, 'EV', 'EWR', 43939),
 (12, 'UA', 'EWR', 46087),
 (1, 'HA', 'JFK', 342),
 (2, 'EV', 'JFK', 1408),
 (3, 'US', 'JFK', 2995),
 (4, 'VX', 'JFK', 3596),
 (5, 'UA', 'JFK', 4534),
 (6, 'MQ', 'JFK', 7193),
 (7, 'AA', 'JFK', 13783),
 (8, '9E', 'JFK', 14651),
 (9, 'DL', 'JFK', 20701),
 (10, 'B6', 'JFK', 42076),
 (1, 'OO', 'LGA', 26),
 (2, 'YV', 'LGA', 601),
 (3, 'F9', 'LGA', 685),
 (4, '9E', 'LGA', 2541),
 (5, 'FL', 'LGA', 3260),
 (6, 'B6', 'LGA', 6002),
 (7, 'WN', 'LGA', 6087),
 (8, 'UA', 'LGA', 8044),
 (9, 'EV', 'LGA', 8826),
 (10, 'US', 'LGA', 13136),
 (11, 'AA', 'LGA', 15459),
 (12, 'MQ', 'LGA', 16928),
 (13, 'DL', 'LGA', 23067)]



&lt;IPython.core.display.Javascript object&gt;</code></pre>
<p>Finally, to find the most popular carriers, we can filter this table
to only the rows where <code>rank=1</code>. To do this I will use a
<em>subquery</em>:</p>
<p><code>SELECT * FROM (&lt;another query&gt;)</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cur.execute(<span class="string">"""</span></span><br><span class="line"><span class="string">    SELECT * FROM (SELECT RANK() OVER (</span></span><br><span class="line"><span class="string">        PARTITION BY origin</span></span><br><span class="line"><span class="string">        ORDER BY n DESC</span></span><br><span class="line"><span class="string">    ) AS r, carrier, origin, n FROM</span></span><br><span class="line"><span class="string">    (SELECT COUNT() as n, carrier, origin FROM flights GROUP BY carrier, origin)</span></span><br><span class="line"><span class="string">    ) WHERE r = 1</span></span><br><span class="line"><span class="string">"""</span>).fetchall()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>[(1, 'UA', 'EWR', 46087), (1, 'B6', 'JFK', 42076), (1, 'DL', 'LGA', 23067)]</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cur.execute(<span class="string">"""</span></span><br><span class="line"><span class="string">    SELECT * FROM (SELECT RANK() OVER (</span></span><br><span class="line"><span class="string">        PARTITION BY origin</span></span><br><span class="line"><span class="string">        ORDER BY n DESC</span></span><br><span class="line"><span class="string">    ) AS r, carrier, origin, n FROM</span></span><br><span class="line"><span class="string">    (SELECT COUNT() as n, carrier, origin FROM flights GROUP BY carrier, origin)</span></span><br><span class="line"><span class="string">    ) AS subq JOIN airlines ON airlines.carrier = subq.carrier</span></span><br><span class="line"><span class="string">    WHERE r = 1 </span></span><br><span class="line"><span class="string">"""</span>).fetchall()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>[(1, 'B6', 'JFK', 42076, 'B6', 'JetBlue Airways'),
 (1, 'DL', 'LGA', 23067, 'DL', 'Delta Air Lines Inc.'),
 (1, 'UA', 'EWR', 46087, 'UA', 'United Air Lines Inc.')]</code></pre>
<h2 id="what-are-the-busiest-travel-weeks-of-the-year">What are the
busiest travel weeks of the year?</h2>
<p>We need to figure out the week of each flight, and then aggregate
them. To manipulate dates in sqlite, we have the <a target="_blank" rel="noopener" href="https://www.sqlite.org/lang_datefunc.html"><code>strftime()</code>
function</a>:</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cur.execute(<span class="string">"""SELECT strftime('%W', 'now')"""</span>).fetchone()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>('11',)</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cur.execute(<span class="string">"""SELECT strftime('The day of the week is %w, the week of the year is %W', 'now')"""</span>).fetchone()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>('The day of the week is 0, the week of the year is 11',)</code></pre>
<h2 id="the-unix-epoch">The Unix epoch</h2>
<p>The <code>time_hour</code> column in <code>flights</code> looks
like:</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cur.execute(<span class="string">"""SELECT time_hour FROM flights"""</span>).fetchone()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>(1357034400.0,)</code></pre>
<p>This number represents the number of seconds that have elapsed since
midnight GMT on January 1, 1970, a date known as the <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Unix_time">Unix epoch</a>. We can
use <code>strftime()</code> on these dates provided we tell it how they
are formatted.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># datetime() is an alias for strftime('%Y-%m-%d %H:%M:%S', ...)</span></span><br><span class="line">cur.execute(<span class="string">"""SELECT datetime(1357034400, 'unixepoch')"""</span>).fetchone()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>('2013-01-01 10:00:00',)</code></pre>
<p>Now we can convert each date to a week of the year:</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.read_sql_query(<span class="string">"""SELECT year, month, day, strftime('%W', time_hour, 'unixepoch') from flights"""</span>, con)</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
year
</th>
<th>
month
</th>
<th>
day
</th>
<th>
strftime('%W', time_hour, 'unixepoch')
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
2013
</td>
<td>
1
</td>
<td>
1
</td>
<td>
00
</td>
</tr>
<tr>
<th>
1
</th>
<td>
2013
</td>
<td>
1
</td>
<td>
1
</td>
<td>
00
</td>
</tr>
<tr>
<th>
2
</th>
<td>
2013
</td>
<td>
1
</td>
<td>
1
</td>
<td>
00
</td>
</tr>
<tr>
<th>
3
</th>
<td>
2013
</td>
<td>
1
</td>
<td>
1
</td>
<td>
00
</td>
</tr>
<tr>
<th>
4
</th>
<td>
2013
</td>
<td>
1
</td>
<td>
1
</td>
<td>
00
</td>
</tr>
<tr>
<th>
...
</th>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
<td>
...
</td>
</tr>
<tr>
<th>
336771
</th>
<td>
2013
</td>
<td>
9
</td>
<td>
30
</td>
<td>
39
</td>
</tr>
<tr>
<th>
336772
</th>
<td>
2013
</td>
<td>
9
</td>
<td>
30
</td>
<td>
39
</td>
</tr>
<tr>
<th>
336773
</th>
<td>
2013
</td>
<td>
9
</td>
<td>
30
</td>
<td>
39
</td>
</tr>
<tr>
<th>
336774
</th>
<td>
2013
</td>
<td>
9
</td>
<td>
30
</td>
<td>
39
</td>
</tr>
<tr>
<th>
336775
</th>
<td>
2013
</td>
<td>
9
</td>
<td>
30
</td>
<td>
39
</td>
</tr>
</tbody>
</table>
<p>
336776 rows × 4 columns
</p>
</div>
<p>The final query looks like:</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">con.execute(<span class="string">"""</span></span><br><span class="line"><span class="string">    SELECT COUNT() as n, strftime('%W', time_hour, 'unixepoch') as week FROM flights</span></span><br><span class="line"><span class="string">    GROUP BY week</span></span><br><span class="line"><span class="string">    ORDER BY n DESC</span></span><br><span class="line"><span class="string">"""</span>).fetchall()[:<span class="number">10</span>]</span><br></pre></td></tr></tbody></table></figure>
<pre><code>[(6760, '27'),
 (6740, '29'),
 (6737, '28'),
 (6735, '30'),
 (6733, '31'),
 (6702, '25'),
 (6687, '32'),
 (6675, '24'),
 (6639, '23'),
 (6631, '33')]</code></pre>
<h2 id="what-where-the-ten-worst-days-for-average-departure-delay">What
where the ten worst days for average departure delay?</h2>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">con.execute(<span class="string">'''SELECT year, month, day, AVG(dep_delay) AS avg_delay</span></span><br><span class="line"><span class="string">            FROM flights GROUP BY year, month, day </span></span><br><span class="line"><span class="string">            ORDER BY avg_delay DESC</span></span><br><span class="line"><span class="string">            LIMIT 10'''</span>).fetchall()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>[(2013, 3, 8, 83.5369211514393),
 (2013, 7, 1, 56.23382519863791),
 (2013, 9, 2, 53.029550827423165),
 (2013, 7, 10, 52.860702151755376),
 (2013, 12, 5, 52.32799013563502),
 (2013, 5, 23, 51.14471968709257),
 (2013, 9, 12, 49.95875),
 (2013, 6, 28, 48.827784156142364),
 (2013, 6, 24, 47.15741789354473),
 (2013, 7, 22, 46.66704675028506)]</code></pre>
<h2 id="what-where-the-ten-best-days-for-departure-delay">What where the
ten best days for departure delay?</h2>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">con.execute(<span class="string">'''SELECT year, month, day, AVG(dep_delay) AS avg_delay</span></span><br><span class="line"><span class="string">            FROM flights GROUP BY year, month, day </span></span><br><span class="line"><span class="string">            ORDER BY avg_delay ASC</span></span><br><span class="line"><span class="string">            LIMIT 10'''</span>).fetchall()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>[(2013, 9, 24, -1.3298319327731092),
 (2013, 10, 2, -0.919917864476386),
 (2013, 11, 9, -0.6288515406162465),
 (2013, 9, 6, -0.39792746113989635),
 (2013, 9, 5, -0.3877973112719752),
 (2013, 10, 29, -0.34932221063607927),
 (2013, 9, 7, -0.25036390101892286),
 (2013, 11, 5, -0.18314255983350677),
 (2013, 10, 19, -0.10703812316715543),
 (2013, 10, 1, -0.09895833333333333)]</code></pre>
<h2 id="what-airlines-have-the-most-departure-delay">What airlines have
the most departure delay?</h2>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">con.execute(<span class="string">'''SELECT airlines.carrier, name, AVG(dep_delay) AS avg_delay</span></span><br><span class="line"><span class="string">            FROM flights</span></span><br><span class="line"><span class="string">            JOIN airlines on airlines.carrier=flights.carrier</span></span><br><span class="line"><span class="string">            GROUP BY airlines.name</span></span><br><span class="line"><span class="string">            ORDER BY avg_delay DESC</span></span><br><span class="line"><span class="string">            LIMIT 10'''</span>).fetchall()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>[('F9', 'Frontier Airlines Inc.', 20.215542521994134),
 ('EV', 'ExpressJet Airlines Inc.', 19.955389827868213),
 ('YV', 'Mesa Airlines Inc.', 18.996330275229358),
 ('FL', 'AirTran Airways Corporation', 18.72607467838092),
 ('WN', 'Southwest Airlines Co.', 17.71174377224199),
 ('9E', 'Endeavor Air Inc.', 16.725769407441433),
 ('B6', 'JetBlue Airways', 13.022522106740018),
 ('VX', 'Virgin America', 12.869421165464821),
 ('OO', 'SkyWest Airlines Inc.', 12.586206896551724),
 ('UA', 'United Air Lines Inc.', 12.106072888459614)]</code></pre>
<h2 id="what-airplane-flew-the-most-days">What airplane flew the most
days?</h2>
<p>Airplanes are identified by their tail number.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cur.execute(<span class="string">'''SELECT tailnum, COUNT() AS n FROM</span></span><br><span class="line"><span class="string">    (SELECT DISTINCT year, month, day, tailnum FROM flights)</span></span><br><span class="line"><span class="string">    GROUP BY tailnum</span></span><br><span class="line"><span class="string">    ORDER BY n DESC</span></span><br><span class="line"><span class="string">    LIMIT 1</span></span><br><span class="line"><span class="string">'''</span>).fetchall()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>[('N328AA', 336)]</code></pre>
<p>Interestingly, you can Google most tail numbers: <a target="_blank" rel="noopener" href="https://www.planespotters.net/airframe/boeing-767-200-n328aa-american-airlines/enj523">N328AA</a>.</p>
<h2 id="how-many-flights-were-cancelled">How many flights were
cancelled?</h2>
<p>We'll say that a cancelled flight has <code>dep_time</code>
missing.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cur.execute(<span class="string">'''SELECT COUNT() FROM flights WHERE dep_time IS NULL'''</span>).fetchone()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>(0,)</code></pre>
<p>Notice that we don't write <code>= NULL</code>. That does not
work:</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cur.execute(<span class="string">'''SELECT COUNT() FROM flights WHERE dep_time = NULL'''</span>).fetchone()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>(0,)</code></pre>
<h2 id="how-many-flights-were-destined-for-airports-with-a-one-word-name">How
many flights were destined for airports with a one word name?</h2>
<p>(Not including the word "airport")</p>
<p>Here is an example of an airport with a one-word name:</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cur.execute(<span class="string">"SELECT * FROM airports WHERE name = 'Packwood'"</span>).description</span><br></pre></td></tr></tbody></table></figure>
<pre><code>(('faa', None, None, None, None, None, None),
 ('name', None, None, None, None, None, None),
 ('lat', None, None, None, None, None, None),
 ('lon', None, None, None, None, None, None),
 ('alt', None, None, None, None, None, None),
 ('tz', None, None, None, None, None, None),
 ('dst', None, None, None, None, None, None),
 ('tzone', None, None, None, None, None, None))



&lt;IPython.core.display.Javascript object&gt;</code></pre>
<blockquote>
<p>CAST(xxx AS INTEGER)</p>
</blockquote>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cur.execute(</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    SELECT name</span></span><br><span class="line"><span class="string">    FROM airports WHERE name NOT LIKE '% %'</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">).fetchall()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>[('Packwood',),
 ('Florence',),
 ('Arcata',),
 ('Kodiak',),
 ('Addison',),
 ('Alexandria',),
 ('Centennial',),
 ('Lakeland',),
 ('Appleton',),
 ('Executive',),
 ('Avalon',),
 ('Kalamazoo',),
 ('Bethel',),
 ('Beaufort',),
 ('Bettles',),
 ('KBWD',),
 ('CedarKey',),
 ('Clemson',),
 ('Charlottesville-Albemarle',),
 ('Chehalis-Centralia',),
 ('Champaign',),
 ('Yeager',),
 ('Tri-Cities',),
 ('Decatur',),
 ('Dillingham',),
 ('Dupage',),
 ('Destin',),
 ('Unalaska',),
 ('Orlando',),
 ('Bessemer',),
 ('Wendover',),
 ('Franklin',),
 ('Tipton',),
 ('Gulkana',),
 ('Gulfport-Biloxi',),
 ('Majors',),
 ('Dillingham',),
 ('Hana',),
 ('Homer',),
 ('Iliamna',),
 ('Immokalee',),
 ('Kapalua',),
 ('Logan-Cache',),
 ('Lihue',),
 ('Lincoln',),
 ('Lanai',),
 ('Castle',),
 ('Mojave',),
 ('Downtown',),
 ('Molokai',),
 ('Manassas',),
 ('MariposaYosemite',),
 ('Lakefront',),
 ('County',),
 ('Kahului',),
 ('Nome',),
 ('Executive',),
 ('Northway',),
 ('Platinum',),
 ('Renton',),
 ('Rochester',),
 ('Prosser',),
 ('Deadhorse',),
 ('Sedona',),
 ('Gillespie',),
 ('Teterboro',),
 ('Telluride',),
 ('Talkeetna',),
 ('Toledo',),
 ('Upolu',),
 ('Apopka',),
 ('Yakutat',),
 ('Clear',)]



&lt;IPython.core.display.Javascript object&gt;</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cur.execute(</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    SELECT COUNT() FROM flights</span></span><br><span class="line"><span class="string">    INNER JOIN (SELECT faa FROM airports WHERE name NOT LIKE '% %') one_word</span></span><br><span class="line"><span class="string">    ON one_word.faa = flights.dest</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">).fetchall()</span><br></pre></td></tr></tbody></table></figure>
<pre><code>[(190,)]



&lt;IPython.core.display.Javascript object&gt;</code></pre>

    </div>

    
    
    
      

  <div class="popular-posts-header">Related Posts</div>
  <ul class="related-posts">
  
      <li class="related-posts-item"><a href="/Programming-in-Python-1/">Programming in Python (1)</a></li>
  
      <li class="related-posts-item"><a href="/Python-Generator-and-Iterator-LC-173/">Python Generator and Iterator LC 173</a></li>
  
      <li class="related-posts-item"><a href="/Tree-Traverse/">Tree Traverse</a></li>
  
      <li class="related-posts-item"><a href="/Python-Algorithm-and-Data-Structure/">Python Algorithm and Data Structure</a></li>
  
      <li class="related-posts-item"><a href="/Pyspark/">Pyspark</a></li>
  
  </ul>


    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>Jun XU
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://xuj14.github.io/Programming-in-Python-2/" title="Programming in Python (2)">https://xuj14.github.io/Programming-in-Python-2/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Python/" rel="tag"><i class="fa fa-tag"></i> Python</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/How-to-Win-a-Data-Science-Competition-Learn-from-Top-Kagglers/" rel="prev" title="How to Win a Data Science Competition">
                  <i class="fa fa-chevron-left"></i> How to Win a Data Science Competition
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/Pyspark/" rel="next" title="Pyspark">
                  Pyspark <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jun XU</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>Symbols count total: </span>
    <span title="Symbols count total">170k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>Reading time total &asymp;</span>
    <span title="Reading time total">2:35</span>
  </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <script size="300" alpha="0.6" zIndex="-1" src="https://cdnjs.cloudflare.com/ajax/libs/ribbon.js/1.0.2/ribbon.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.0/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.2.8/pdfobject.min.js","integrity":"sha256-tu9j5pBilBQrWSDePOOajCUdz6hWsid/lBNzK4KgEPM="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js"></script>



  <script src="/js/third-party/pace.js"></script>

  


  <script class="next-config" data-name="leancloud_visitors" type="application/json">{"enable":true,"app_id":"Oe6lNLDUFdCT4aO5HYh597Om-MdYXbMMI","app_key":"2dnAg0FTC6n2hMWsLlwd2Ncj","server_url":"https://xuj14.github.io/","security":true}</script>
  <script src="/js/third-party/statistics/lean-analytics.js"></script>


  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true}});</script></body>
</html>
